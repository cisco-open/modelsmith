"use strict";(self.webpackChunkmodelsmith=self.webpackChunkmodelsmith||[]).push([[884],{884:(st,Q,n)=>{n.r(Q),n.d(Q,{ModelCompressionModule:()=>rt});var c,m=n(6814),x=n(4245),C=n(7582),t=n(5879),s=n(6223),M=n(5195),T=n(5683),I=n(617),y=n(8525),a=n(8791),L=n(3427),J=n(1374),A=n(7398),E=n(7921),b=n(3607),S=n(4378),h=n(7820),g=n(127),D=n(3705),O=n(8471),u=n(3680);function Y(i,e){1&i&&t._UZ(0,"mat-icon",12)}function K(i,e){if(1&i&&(t.TgZ(0,"mat-option",10),t._uU(1),t.YNc(2,Y,1,0,"mat-icon",11),t.qZA()),2&i){const o=e.$implicit;t.Q6J("value",o.name)("disabled",!o.isTrained),t.xp6(1),t.hij(" ",o.name," "),t.xp6(1),t.Q6J("ngIf",!o.isTrained)}}function z(i,e){1&i&&(t.TgZ(0,"mat-option",13),t._uU(1,"No results found"),t.qZA())}function V(i,e){if(1&i&&(t.ynx(0),t.YNc(1,K,3,4,"mat-option",8),t.YNc(2,z,2,0,"mat-option",9),t.BQk()),2&i){const o=e.ngIf,r=t.oxw();t.xp6(1),t.Q6J("ngForOf",o)("ngForTrackBy",r.trackByModel),t.xp6(1),t.Q6J("ngIf",0===o.length)}}let f=((c=class{ngOnChanges(e){e.algorithm&&e.algorithm.currentValue&&this.configureModels(e.algorithm.currentValue)}get parentFormGroup(){return this.controlContainer.control}get modelFormGroup(){return this.parentFormGroup.get(this.controlKey)}get modelControl(){return this.modelFormGroup.get(this.MODEL_CONTROL_NAME)}constructor(e,o,r){this.controlContainer=e,this.modelsFacadeService=o,this.scriptFacadeService=r,this.controlKey="",this.searchModel=new s.NI,this.models=[],this.MODEL_CONTROL_NAME="model"}ngOnInit(){this.initializeForm(),this.listenToScriptStateChanges(),this.listenToSearchModelValueChanges()}configureModels(e){const o=(0,h.t6)(e);o&&(this.fetchModels(o),this.loadInitialModel(o))}loadInitialModel(e){this.modelsFacadeService.currentModel$.pipe((0,J.P)(o=>!(0,S.Bm)(o))).subscribe(o=>{this.modelControl?.patchValue(o)}),this.modelsFacadeService.dispatch(b.o.getCurrentOrPreviousSelectedModel({algorithmType:e}))}fetchModels(e){this.modelsFacadeService.getModelsByType(e).pipe((0,J.P)(o=>!(0,S.yD)(o)),(0,A.U)(o=>[...o].sort((r,l)=>Number(l.isTrained)-Number(r.isTrained)))).subscribe(o=>{this.models=o,this.searchModel.setValue("")}),this.modelsFacadeService.dispatch(b.o.getModelsList({algorithmType:e}))}initializeForm(){this.parentFormGroup.addControl(this.controlKey,new s.cw({[this.MODEL_CONTROL_NAME]:new s.NI("",s.kI.required)}))}listenToScriptStateChanges(){this.scriptFacadeService.scriptStatus$.pipe((0,a.t)(this)).subscribe(e=>{(0,g.A)(e)?this.modelFormGroup.disable():this.modelFormGroup.enable()})}listenToSearchModelValueChanges(){this.filteredModels=this.searchModel.valueChanges.pipe((0,a.t)(this),(0,E.O)(""),(0,A.U)(e=>this.filterModels(e)))}filterModels(e){const o=e.toLowerCase();return this.models.filter(r=>r.name.toLowerCase().includes(o))}trackByModel(e,o){return o.name}ngOnDestroy(){this.parentFormGroup.removeControl(this.controlKey)}}).\u0275fac=function(e){return new(e||c)(t.Y36(s.gN),t.Y36(D.V),t.Y36(O.O))},c.\u0275cmp=t.Xpm({type:c,selectors:[["ms-panel-model"]],inputs:{controlKey:"controlKey",algorithm:"algorithm"},standalone:!0,features:[t._Bn([],[{provide:s.gN,useFactory:()=>(0,t.f3M)(s.gN,{skipSelf:!0})}]),t.TTD,t.jDz],decls:11,vars:5,consts:[[1,"ms-card","model-card"],[1,"heading-sub-section-title"],[1,"form-field-container",3,"formGroupName"],["appearance","outline","subscriptSizing","dynamic"],["formControlName","model","placeholder","Select a model..."],["label","Predefined Models"],[3,"formControl"],[4,"ngIf"],[3,"value","disabled",4,"ngFor","ngForOf","ngForTrackBy"],["disabled","",4,"ngIf"],[3,"value","disabled"],["class","mat-error","fontSet","ms","fontIcon","icon-X",4,"ngIf"],["fontSet","ms","fontIcon","icon-X",1,"mat-error"],["disabled",""]],template:function(e,o){1&e&&(t.TgZ(0,"mat-card",0)(1,"p",1),t._uU(2,"Model"),t.qZA(),t.TgZ(3,"div",2)(4,"mat-form-field",3)(5,"mat-select",4)(6,"mat-optgroup",5)(7,"mat-option"),t._UZ(8,"ngx-mat-select-search",6),t.qZA(),t.YNc(9,V,3,3,"ng-container",7),t.ALo(10,"async"),t.qZA()()()()()),2&e&&(t.xp6(3),t.Q6J("formGroupName",o.controlKey),t.xp6(5),t.Q6J("formControl",o.searchModel),t.xp6(1),t.Q6J("ngIf",t.lcZ(10,3,o.filteredModels)))},dependencies:[s.UX,s.JJ,s.JL,s.oH,s.u,s.x0,M.QW,M.a8,T.lN,T.KE,y.LD,y.gD,u.ey,u.Nv,I.Ps,I.Hw,m.ez,m.sg,m.O5,m.Ov,L.Co,L.nu]}),c);f=(0,C.gn)([(0,a.c)()],f);var G=n(1668),B=n(1543),F=n(4190),$=n(3620),H=n(3997),U=n(2181),j=n(39),X=n(9547);const R="custommodel";var p,k=n(999),w=n(8450),q=n(2296),_=n(8180),v=n(8279);function tt(i,e){if(1&i&&(t.TgZ(0,"mat-option",9),t._uU(1),t.qZA()),2&i){const o=e.$implicit;t.Q6J("value",o.key),t.xp6(1),t.hij(" ",o.value," ")}}function et(i,e){if(1&i&&(t.TgZ(0,"mat-option",9),t._uU(1),t.qZA()),2&i){const o=e.$implicit;t.Q6J("value",o.key),t.xp6(1),t.hij(" ",o.value," ")}}let N=((p=class{get algorithmFormControl(){return this.form.get(this.ALGORITHM_CONTROL_NAME)}constructor(e,o,r){this.fb=e,this.controlContainer=o,this.scriptFacadeService=r,this.pruningAlgorithmsList=v.dD,this.quantAlgorithmsList=v.A3,this.ALGORITHM_CONTROL_NAME="alg"}ngOnInit(){this.initForm(),this.listenToScriptStateChanges(),this.loadInitialData()}loadInitialData(){this.scriptFacadeService.scriptDetails$.pipe((0,_.q)(1),(0,U.h)(e=>!!e?.algKey)).subscribe(e=>{const o=e.type,l=o===h.Bd.PRUNING||o===h.Bd.QUANTIZATION?e.algKey:v.k2;this.algorithmFormControl?.setValue(l)}),this.scriptFacadeService.dispatch(j.aj.getCurrentOrLastActiveScriptDetails())}initForm(){this.form=this.fb.group({[this.ALGORITHM_CONTROL_NAME]:[v.k2,s.kI.required]}),this.controlContainer?.control?.parent?.setControl(this.controlContainer.name,this.form)}listenToScriptStateChanges(){this.scriptFacadeService.scriptStatus$.pipe((0,a.t)(this)).subscribe(e=>{(0,g.A)(e)?this.form.disable():this.form.enable()})}trackByAlgorithmKey(e,o){return o.key}}).\u0275fac=function(e){return new(e||p)(t.Y36(s.qu),t.Y36(s.gN),t.Y36(O.O))},p.\u0275cmp=t.Xpm({type:p,selectors:[["ms-panel-algorithm"]],decls:11,vars:6,consts:[[1,"ms-card","algorithm-card"],[1,"heading-sub-section-title"],[3,"formGroup"],[1,"form-field-container"],["appearance","outline","subscriptSizing","dynamic"],[3,"formControlName"],["label","Pruning"],[3,"value",4,"ngFor","ngForOf","ngForTrackBy"],["label","Quantization"],[3,"value"]],template:function(e,o){1&e&&(t.TgZ(0,"mat-card",0)(1,"p",1),t._uU(2,"Algorithm"),t.qZA(),t.ynx(3,2),t.TgZ(4,"div",3)(5,"mat-form-field",4)(6,"mat-select",5)(7,"mat-optgroup",6),t.YNc(8,tt,2,2,"mat-option",7),t.qZA(),t.TgZ(9,"mat-optgroup",8),t.YNc(10,et,2,2,"mat-option",7),t.qZA()()()(),t.BQk(),t.qZA()),2&e&&(t.xp6(3),t.Q6J("formGroup",o.form),t.xp6(3),t.Q6J("formControlName",o.ALGORITHM_CONTROL_NAME),t.xp6(2),t.Q6J("ngForOf",o.pruningAlgorithmsList)("ngForTrackBy",o.trackByAlgorithmKey),t.xp6(2),t.Q6J("ngForOf",o.quantAlgorithmsList)("ngForTrackBy",o.trackByAlgorithmKey))},dependencies:[m.sg,M.a8,T.KE,y.gD,u.ey,u.Nv,s.JJ,s.JL,s.sg,s.u]}),p);var d;N=(0,C.gn)([(0,a.c)()],N);const ot=["panelParameters"];let P=((d=class{constructor(e,o,r,l,Z){this.scriptFacadeService=e,this.fb=o,this.fileService=r,this.snackbarService=l,this.router=Z,this.AlgorithmType=h.Bd,this.isScriptActive=!1,this.isQuantAlgorithmSelected=!1,this.initForm()}ngOnInit(){this.listenToAlgorithmPanelChanges(),this.listenToScriptStateChanges()}listenToAlgorithmPanelChanges(){this.form.valueChanges.pipe((0,$.b)(50),(0,A.U)(e=>e.algorithm&&e.algorithm.alg),(0,H.x)(),(0,U.h)(e=>!!e),(0,a.t)(this)).subscribe(e=>{this.selectedAlgorithm=e})}listenToScriptStateChanges(){this.scriptFacadeService.scriptStatus$.pipe((0,a.t)(this)).subscribe(e=>{this.isScriptActive=(0,g.A)(e),(0,g.A)(e)?this.form.disable():this.form.enable()})}initForm(){this.form=this.fb.group({algorithm:[]})}submit(){if((0,S.Qr)(this.selectedAlgorithm))return void this.snackbarService.showError("Select an algorithm before running a script.");const{algorithm:e,model:o}=this.form.getRawValue(),{model:r}=o;if(r===R&&!this.fileService.isFileLoaded)return void this.snackbarService.showError("Please select a predefined model or upload a custom file.");let l=r===R?function W(i){let e=i.replace(/[^a-zA-Z0-9_]/g,"_");return/^[0-9_]/.test(e)&&(e="file_"+e),/.py$/.test(e)||(e+=".py"),e}(this.fileService?.file.name):r;const Z={...e,params:{...this.panelParametersComponent.parametersFormatted,arch:l}};this.scriptFacadeService.dispatch(j.aj.callScript({configs:Z}))}goToChartPage(){this.router.navigate([X.Z.RUNNING.ROOT])}}).\u0275fac=function(e){return new(e||d)(t.Y36(O.O),t.Y36(s.qu),t.Y36(k.I),t.Y36(w.QD),t.Y36(F.F0))},d.\u0275cmp=t.Xpm({type:d,selectors:[["ms-machine-unlearning"]],viewQuery:function(e,o){if(1&e&&t.Gf(ot,5),2&e){let r;t.iGM(r=t.CRH())&&(o.panelParametersComponent=r.first)}},decls:17,vars:5,consts:[[1,"heading-primary-title","title"],[1,"project-settings-wrapper",3,"formGroup"],[1,"left"],[3,"formGroup"],["formGroupName","algorithm"],["panelAlgorithm",""],["controlKey","model",3,"algorithm"],["controlKey","params",3,"algorithm"],["panelParameters",""],["mat-raised-button","","color","primary",3,"disabled","click"],["mat-raised-button","","color","primary",1,"ml-2",3,"click"],[1,"right"]],template:function(e,o){1&e&&(t.TgZ(0,"p",0),t._uU(1,"Project Settings"),t.qZA(),t.TgZ(2,"div",1)(3,"div",2),t.ynx(4,3),t._UZ(5,"ms-panel-algorithm",4,5)(7,"ms-panel-model",6)(8,"ms-panel-parameters",7,8),t.BQk(),t.TgZ(10,"div")(11,"button",9),t.NdJ("click",function(){return o.submit()}),t._uU(12," Run "),t.qZA(),t.TgZ(13,"button",10),t.NdJ("click",function(){return o.goToChartPage()}),t._uU(14,"View Chart"),t.qZA()()(),t.TgZ(15,"div",11),t._UZ(16,"ms-terminal"),t.qZA()()),2&e&&(t.xp6(2),t.Q6J("formGroup",o.form),t.xp6(2),t.Q6J("formGroup",o.form),t.xp6(3),t.Q6J("algorithm",o.selectedAlgorithm),t.xp6(1),t.Q6J("algorithm",o.selectedAlgorithm),t.xp6(3),t.Q6J("disabled",o.isScriptActive||o.form.invalid))},dependencies:[q.lW,s.JL,s.sg,s.x0,B.d,f,G.w,N],styles:[".title[_ngcontent-%COMP%]{margin-bottom:13px}.project-settings-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:20px;height:100%}.project-settings-wrapper[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:45%;gap:20px}.project-settings-wrapper[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{width:55%}"]}),d);P=(0,C.gn)([(0,a.c)()],P);const it=[{path:"",component:P}];let nt=(()=>{var i;class e{}return(i=e).\u0275fac=function(r){return new(r||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[F.Bz.forChild(it),F.Bz]}),e})(),rt=(()=>{var i;class e{}return(i=e).\u0275fac=function(r){return new(r||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[m.ez,x.m,nt,B.d,f,G.w]}),e})()}}]);