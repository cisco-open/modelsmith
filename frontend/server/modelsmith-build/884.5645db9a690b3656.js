"use strict";(self.webpackChunkmodelsmith=self.webpackChunkmodelsmith||[]).push([[884],{884:(st,Z,i)=>{i.r(Z),i.d(Z,{ModelCompressionModule:()=>it});var c,m=i(6814),U=i(4245),C=i(7582),t=i(5879),r=i(6223),M=i(5195),y=i(5683),G=i(617),T=i(8525),a=i(8791),L=i(3427),b=i(1374),S=i(7398),j=i(7921),Q=i(3607),A=i(4378),h=i(7820),g=i(127),x=i(3705),F=i(8471),u=i(3680);function D(n,e){1&n&&t._UZ(0,"mat-icon",12)}function E(n,e){if(1&n&&(t.TgZ(0,"mat-option",10),t._uU(1),t.YNc(2,D,1,0,"mat-icon",11),t.qZA()),2&n){const o=e.$implicit;t.Q6J("value",o.name)("disabled",!o.isTrained),t.xp6(1),t.hij(" ",o.name," "),t.xp6(1),t.Q6J("ngIf",!o.isTrained)}}function z(n,e){1&n&&(t.TgZ(0,"mat-option",13),t._uU(1,"No results found"),t.qZA())}function Y(n,e){if(1&n&&(t.ynx(0),t.YNc(1,E,3,4,"mat-option",8),t.YNc(2,z,2,0,"mat-option",9),t.BQk()),2&n){const o=e.ngIf,s=t.oxw();t.xp6(1),t.Q6J("ngForOf",o)("ngForTrackBy",s.trackByModel),t.xp6(1),t.Q6J("ngIf",0===o.length)}}let f=((c=class{ngOnChanges(e){e.algorithm&&e.algorithm.currentValue&&this.configureModels(e.algorithm.currentValue)}get parentFormGroup(){return this.controlContainer.control}get modelFormGroup(){return this.parentFormGroup.get(this.controlKey)}get modelControl(){return this.modelFormGroup.get(this.MODEL_CONTROL_NAME)}constructor(e,o,s){this.controlContainer=e,this.modelsFacadeService=o,this.scriptFacadeService=s,this.controlKey="",this.searchModel=new r.NI,this.models=[],this.MODEL_CONTROL_NAME="model"}ngOnInit(){this.initializeForm(),this.listenToScriptStateChanges(),this.listenToSearchModelValueChanges(),this.listenToCurrentModelChanges()}configureModels(e){const o=(0,h.t6)(e);o&&(this.fetchModels(o),this.modelsFacadeService.dispatch(Q.o.getCurrentOrPreviousSelectedModel({algorithmType:o})))}listenToCurrentModelChanges(){this.modelsFacadeService.currentModel$.pipe((0,a.t)(this)).subscribe(e=>{(0,A.Bm)(e)||this.modelControl?.patchValue(e)})}fetchModels(e){this.modelsFacadeService.getModelsByType(e).pipe((0,b.P)(o=>!(0,A.yD)(o)),(0,S.U)(o=>[...o].sort((s,l)=>Number(l.isTrained)-Number(s.isTrained)))).subscribe(o=>{this.models=o,this.searchModel.setValue("")}),this.modelsFacadeService.dispatch(Q.o.getModelsList({algorithmType:e}))}initializeForm(){this.parentFormGroup.addControl(this.controlKey,new r.cw({[this.MODEL_CONTROL_NAME]:new r.NI("",r.kI.required)}))}listenToScriptStateChanges(){this.scriptFacadeService.scriptStatus$.pipe((0,a.t)(this)).subscribe(e=>{(0,g.A)(e)?this.modelFormGroup.disable():this.modelFormGroup.enable()})}listenToSearchModelValueChanges(){this.filteredModels=this.searchModel.valueChanges.pipe((0,a.t)(this),(0,j.O)(""),(0,S.U)(e=>this.filterModels(e)))}filterModels(e){const o=e.toLowerCase();return this.models.filter(s=>s.name.toLowerCase().includes(o))}trackByModel(e,o){return o.name}ngOnDestroy(){this.parentFormGroup.removeControl(this.controlKey)}}).\u0275fac=function(e){return new(e||c)(t.Y36(r.gN),t.Y36(x.V),t.Y36(F.O))},c.\u0275cmp=t.Xpm({type:c,selectors:[["ms-panel-model"]],inputs:{controlKey:"controlKey",algorithm:"algorithm"},standalone:!0,features:[t._Bn([],[{provide:r.gN,useFactory:()=>(0,t.f3M)(r.gN,{skipSelf:!0})}]),t.TTD,t.jDz],decls:11,vars:5,consts:[[1,"ms-card","model-card"],[1,"heading-sub-section-title"],[1,"form-field-container",3,"formGroupName"],["appearance","outline","subscriptSizing","dynamic"],["formControlName","model","placeholder","Select a model..."],["label","Predefined Models"],[3,"formControl"],[4,"ngIf"],[3,"value","disabled",4,"ngFor","ngForOf","ngForTrackBy"],["disabled","",4,"ngIf"],[3,"value","disabled"],["class","mat-error","fontSet","ms","fontIcon","icon-X",4,"ngIf"],["fontSet","ms","fontIcon","icon-X",1,"mat-error"],["disabled",""]],template:function(e,o){1&e&&(t.TgZ(0,"mat-card",0)(1,"p",1),t._uU(2,"Model"),t.qZA(),t.TgZ(3,"div",2)(4,"mat-form-field",3)(5,"mat-select",4)(6,"mat-optgroup",5)(7,"mat-option"),t._UZ(8,"ngx-mat-select-search",6),t.qZA(),t.YNc(9,Y,3,3,"ng-container",7),t.ALo(10,"async"),t.qZA()()()()()),2&e&&(t.xp6(3),t.Q6J("formGroupName",o.controlKey),t.xp6(5),t.Q6J("formControl",o.searchModel),t.xp6(1),t.Q6J("ngIf",t.lcZ(10,3,o.filteredModels)))},dependencies:[r.UX,r.JJ,r.JL,r.oH,r.u,r.x0,M.QW,M.a8,y.lN,y.KE,T.LD,T.gD,u.ey,u.Nv,G.Ps,G.Hw,m.ez,m.sg,m.O5,m.Ov,L.Co,L.nu]}),c);f=(0,C.gn)([(0,a.c)()],f);var I=i(1668),J=i(1543),O=i(4190),V=i(3620),$=i(3997),K=i(2181),R=i(39),H=i(9547);const B="custommodel";var p,W=i(999),w=i(8450),k=i(2296),q=i(8180),v=i(8279);function _(n,e){if(1&n&&(t.TgZ(0,"mat-option",8),t._uU(1),t.qZA()),2&n){const o=e.$implicit;t.Q6J("value",o.key),t.xp6(1),t.hij(" ",o.value," ")}}function tt(n,e){if(1&n&&(t.TgZ(0,"mat-option",8),t._uU(1),t.qZA()),2&n){const o=e.$implicit;t.Q6J("value",o.key),t.xp6(1),t.hij(" ",o.value," ")}}let N=((p=class{get parentFormGroup(){return this.controlContainer.control}get algorithmFormGroup(){return this.parentFormGroup.get(this.controlKey)}get algorithmFormControl(){return this.algorithmFormGroup?.get(this.ALGORITHM_CONTROL_NAME)}constructor(e,o){this.controlContainer=e,this.scriptFacadeService=o,this.controlKey="",this.pruningAlgorithmsList=v.dD,this.quantAlgorithmsList=v.A3,this.ALGORITHM_CONTROL_NAME="alg"}ngOnInit(){this.initForm(),this.listenToScriptStateChanges(),this.loadInitialData()}loadInitialData(){this.scriptFacadeService.scriptDetails$.pipe((0,q.q)(1),(0,K.h)(e=>!!e?.algKey)).subscribe(e=>{const o=e.type,l=o===h.Bd.PRUNING||o===h.Bd.QUANTIZATION?e.algKey:v.k2;this.algorithmFormControl?.setValue(l)}),this.scriptFacadeService.dispatch(R.aj.getCurrentOrLastActiveScriptDetails())}initForm(){this.parentFormGroup.addControl(this.controlKey,new r.cw({[this.ALGORITHM_CONTROL_NAME]:new r.NI(v.k2,r.kI.required)}))}listenToScriptStateChanges(){this.scriptFacadeService.scriptStatus$.pipe((0,a.t)(this)).subscribe(e=>{(0,g.A)(e)?this.algorithmFormGroup.disable():this.algorithmFormGroup.enable()})}trackByAlgorithmKey(e,o){return o.key}ngOnDestroy(){this.parentFormGroup.removeControl(this.controlKey)}}).\u0275fac=function(e){return new(e||p)(t.Y36(r.gN),t.Y36(F.O))},p.\u0275cmp=t.Xpm({type:p,selectors:[["ms-panel-algorithm"]],inputs:{controlKey:"controlKey"},features:[t._Bn([],[{provide:r.gN,useFactory:()=>(0,t.f3M)(r.gN,{skipSelf:!0})}])],decls:10,vars:6,consts:[[1,"ms-card","algorithm-card"],[1,"heading-sub-section-title"],[1,"form-field-container",3,"formGroupName"],["appearance","outline","subscriptSizing","dynamic"],[3,"formControlName"],["label","Pruning"],[3,"value",4,"ngFor","ngForOf","ngForTrackBy"],["label","Quantization"],[3,"value"]],template:function(e,o){1&e&&(t.TgZ(0,"mat-card",0)(1,"p",1),t._uU(2,"Algorithm"),t.qZA(),t.TgZ(3,"div",2)(4,"mat-form-field",3)(5,"mat-select",4)(6,"mat-optgroup",5),t.YNc(7,_,2,2,"mat-option",6),t.qZA(),t.TgZ(8,"mat-optgroup",7),t.YNc(9,tt,2,2,"mat-option",6),t.qZA()()()()()),2&e&&(t.xp6(3),t.Q6J("formGroupName",o.controlKey),t.xp6(2),t.Q6J("formControlName",o.ALGORITHM_CONTROL_NAME),t.xp6(2),t.Q6J("ngForOf",o.pruningAlgorithmsList)("ngForTrackBy",o.trackByAlgorithmKey),t.xp6(2),t.Q6J("ngForOf",o.quantAlgorithmsList)("ngForTrackBy",o.trackByAlgorithmKey))},dependencies:[m.sg,M.a8,y.KE,T.gD,u.ey,u.Nv,r.JJ,r.JL,r.u,r.x0]}),p);var d;N=(0,C.gn)([(0,a.c)()],N);const et=["panelParameters"];let P=((d=class{constructor(e,o,s,l){this.scriptFacadeService=e,this.fileService=o,this.snackbarService=s,this.router=l,this.form=new r.cw({}),this.AlgorithmType=h.Bd,this.isScriptActive=!1,this.isQuantAlgorithmSelected=!1}ngOnInit(){this.listenToAlgorithmPanelChanges(),this.listenToScriptStateChanges()}listenToAlgorithmPanelChanges(){this.form.valueChanges.pipe((0,V.b)(50),(0,S.U)(()=>{const e=this.form.getRawValue();return e.algorithm&&e.algorithm.alg}),(0,$.x)(),(0,K.h)(e=>!!e),(0,a.t)(this)).subscribe(e=>{this.selectedAlgorithm=e})}listenToScriptStateChanges(){this.scriptFacadeService.scriptStatus$.pipe((0,a.t)(this)).subscribe(e=>{this.isScriptActive=(0,g.A)(e),(0,g.A)(e)?this.form.disable():this.form.enable()})}submit(){if((0,A.Qr)(this.selectedAlgorithm))return void this.snackbarService.showError("Select an algorithm before running a script.");const{algorithm:e,model:o}=this.form.getRawValue(),{model:s}=o;if(s===B&&!this.fileService.isFileLoaded)return void this.snackbarService.showError("Please select a predefined model or upload a custom file.");let l=s===B?function X(n){let e=n.replace(/[^a-zA-Z0-9_]/g,"_");return/^[0-9_]/.test(e)&&(e="file_"+e),/.py$/.test(e)||(e+=".py"),e}(this.fileService?.file.name):s;const rt={...e,params:{...this.panelParametersComponent.parametersFormatted,arch:l}};this.scriptFacadeService.dispatch(R.aj.callScript({configs:rt}))}goToChartPage(){this.router.navigate([H.Z.RUNNING.ROOT])}}).\u0275fac=function(e){return new(e||d)(t.Y36(F.O),t.Y36(W.I),t.Y36(w.QD),t.Y36(O.F0))},d.\u0275cmp=t.Xpm({type:d,selectors:[["ms-machine-unlearning"]],viewQuery:function(e,o){if(1&e&&t.Gf(et,5),2&e){let s;t.iGM(s=t.CRH())&&(o.panelParametersComponent=s.first)}},decls:17,vars:5,consts:[[1,"heading-primary-title","title"],[1,"project-settings-wrapper",3,"formGroup"],[1,"left"],[3,"formGroup"],["controlKey","algorithm"],["panelAlgorithm",""],["controlKey","model",3,"algorithm"],["controlKey","params",3,"algorithm"],["panelParameters",""],["mat-raised-button","","color","primary",3,"disabled","click"],["mat-raised-button","","color","primary",1,"ml-2",3,"click"],[1,"right"]],template:function(e,o){1&e&&(t.TgZ(0,"p",0),t._uU(1,"Project Settings"),t.qZA(),t.TgZ(2,"div",1)(3,"div",2),t.ynx(4,3),t._UZ(5,"ms-panel-algorithm",4,5)(7,"ms-panel-model",6)(8,"ms-panel-parameters",7,8),t.BQk(),t.TgZ(10,"div")(11,"button",9),t.NdJ("click",function(){return o.submit()}),t._uU(12," Run "),t.qZA(),t.TgZ(13,"button",10),t.NdJ("click",function(){return o.goToChartPage()}),t._uU(14,"View Chart"),t.qZA()()(),t.TgZ(15,"div",11),t._UZ(16,"ms-terminal"),t.qZA()()),2&e&&(t.xp6(2),t.Q6J("formGroup",o.form),t.xp6(2),t.Q6J("formGroup",o.form),t.xp6(3),t.Q6J("algorithm",o.selectedAlgorithm),t.xp6(1),t.Q6J("algorithm",o.selectedAlgorithm),t.xp6(3),t.Q6J("disabled",o.isScriptActive||o.form.invalid))},dependencies:[k.lW,r.JL,r.sg,J.d,f,I.w,N],styles:[".title[_ngcontent-%COMP%]{margin-bottom:13px}.project-settings-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:20px;height:100%}.project-settings-wrapper[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:45%;gap:20px}.project-settings-wrapper[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{width:55%}"]}),d);P=(0,C.gn)([(0,a.c)()],P);const ot=[{path:"",component:P}];let nt=(()=>{var n;class e{}return(n=e).\u0275fac=function(s){return new(s||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[O.Bz.forChild(ot),O.Bz]}),e})(),it=(()=>{var n;class e{}return(n=e).\u0275fac=function(s){return new(s||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[m.ez,U.m,nt,J.d,f,I.w]}),e})()}}]);