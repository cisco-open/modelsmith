"use strict";(self.webpackChunkmodelsmith=self.webpackChunkmodelsmith||[]).push([[71],{9071:(ht,F,n)=>{n.r(F),n.d(F,{ModelCompressionModule:()=>mt});var m=n(6814),G=n(3670),M=n(1303),A=n(7582),r=n(8791),j=n(3620),P=n(7398),x=n(3997),S=n(2181),E=n(9386),Z=n(4279),Y=n(9547);const f="custommodel";var l=n(7820),u=n(127),t=n(5879),T=n(8471),a=n(6223),I=n(999),z=n(1146),D=n(8450),H=n(6349),V=n(9534),$=n(2296),K=n(7921),Q=n(8180),X=n(3607),L=n(4221),W=n(6590);let B=(()=>{var i;class e{constructor(s){this.store=s}getModelsByType(s){return this.store.select((i=>(0,L.P1)(W.s,e=>{switch(i){case l.Bd.QUANTIZATION:return e.models.quantizationModels;case l.Bd.PRUNING:return e.models.pruningModels;case l.Bd.MACHINE_UNLEARNING:return e.models.machineUnlearningModels;default:return}}))(s))}dispatch(s){this.store.dispatch(s)}}return(i=e).\u0275fac=function(s){return new(s||i)(t.LFG(L.yh))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),e})();var d,U=n(5195),J=n(5683),R=n(8525),v=n(3680),w=n(3427);function q(i,e){if(1&i&&(t.TgZ(0,"mat-option",11),t._uU(1),t.qZA()),2&i){const o=e.$implicit;t.Q6J("value",o),t.xp6(1),t.hij(" ",o," ")}}function _(i,e){1&i&&(t.TgZ(0,"mat-option",12),t._uU(1,"No results found"),t.qZA())}function tt(i,e){if(1&i&&(t.ynx(0),t.YNc(1,q,2,2,"mat-option",9),t.YNc(2,_,2,0,"mat-option",10),t.BQk()),2&i){const o=e.ngIf,s=t.oxw();t.xp6(1),t.Q6J("ngForOf",o)("ngForTrackBy",s.trackByModel),t.xp6(1),t.Q6J("ngIf",0===o.length)}}let y=((d=class{get modelControl(){return this.form.get(this.MODEL_CONTROL_NAME)}constructor(e,o,s,c,g){this.fb=e,this.controlContainer=o,this.fileService=s,this.modelsFacadeService=c,this.scriptFacadeService=g,this.isCustomModelSelected=!1,this.searchModel=new a.NI,this.models=[],this.customModel=f,this.MODEL_CONTROL_NAME="model"}ngOnInit(){this.initializeForm(),this.loadModels(l.Bd.QUANTIZATION),this.listenToModelChanges(),this.listenToScriptStateChanges(),this.filteredModels=this.searchModel.valueChanges.pipe((0,r.t)(this),(0,K.O)(""),(0,P.U)(e=>this.filterModels(e)))}loadModels(e){this.modelsFacadeService.getModelsByType(e).pipe((0,S.h)(o=>!!o&&o.length>0),(0,Q.q)(1)).subscribe(o=>{this.models=o,this.searchModel.setValue("")}),this.modelsFacadeService.dispatch(X.o.getModelsList({algorithmType:e}))}initializeForm(){this.form=this.fb.group({[this.MODEL_CONTROL_NAME]:new a.NI("",a.kI.required)}),this.controlContainer?.control?.parent?.setControl(this.controlContainer.name,this.form)}listenToModelChanges(){this.modelControl?.valueChanges.pipe((0,r.t)(this)).subscribe(e=>{e===f?(this.fileService.file=null,this.isCustomModelSelected=!0):this.isCustomModelSelected=!1})}listenToScriptStateChanges(){this.scriptFacadeService.scriptStatus$.pipe((0,r.t)(this)).subscribe(e=>{(0,u.A)(e)?this.form.disable():this.form.enable()})}filterModels(e){const o=e.toLowerCase();return this.models.filter(s=>s.toLowerCase().includes(o))}trackByModel(e,o){return o}}).\u0275fac=function(e){return new(e||d)(t.Y36(a.qu),t.Y36(a.gN),t.Y36(I.I),t.Y36(B),t.Y36(T.O))},d.\u0275cmp=t.Xpm({type:d,selectors:[["ms-panel-model"]],decls:12,vars:5,consts:[[1,"ms-card","model-card"],[1,"heading-sub-section-title"],[3,"formGroup"],[1,"form-field-container"],["appearance","outline","subscriptSizing","dynamic"],["formControlName","model","placeholder","Select a model..."],["label","Predefined Models"],[3,"formControl"],[4,"ngIf"],[3,"value",4,"ngFor","ngForOf","ngForTrackBy"],["disabled","",4,"ngIf"],[3,"value"],["disabled",""]],template:function(e,o){1&e&&(t.TgZ(0,"mat-card",0)(1,"p",1),t._uU(2,"Model"),t.qZA(),t.ynx(3,2),t.TgZ(4,"div",3)(5,"mat-form-field",4)(6,"mat-select",5)(7,"mat-optgroup",6)(8,"mat-option"),t._UZ(9,"ngx-mat-select-search",7),t.qZA(),t.YNc(10,tt,3,3,"ng-container",8),t.ALo(11,"async"),t.qZA()()()(),t.BQk(),t.qZA()),2&e&&(t.xp6(3),t.Q6J("formGroup",o.form),t.xp6(6),t.Q6J("formControl",o.searchModel),t.xp6(1),t.Q6J("ngIf",t.lcZ(11,3,o.filteredModels)))},dependencies:[m.sg,m.O5,U.a8,J.KE,R.gD,v.ey,v.Nv,a.JJ,a.JL,a.oH,a.sg,a.u,w.nu,m.Ov],changeDetection:0}),d);y=(0,A.gn)([(0,r.c)()],y);var h,et=n(836),ot=n(39),C=n(8279);function it(i,e){if(1&i&&(t.TgZ(0,"mat-option",9),t._uU(1),t.qZA()),2&i){const o=e.$implicit;t.Q6J("value",o.key),t.xp6(1),t.hij(" ",o.value," ")}}function nt(i,e){if(1&i&&(t.TgZ(0,"mat-option",9),t._uU(1),t.qZA()),2&i){const o=e.$implicit;t.Q6J("value",o.key),t.xp6(1),t.hij(" ",o.value," ")}}let O=((h=class{get algorithmFormControl(){return this.form.get(this.ALGORITHM_CONTROL_NAME)}constructor(e,o,s){this.fb=e,this.controlContainer=o,this.scriptFacadeService=s,this.pruningAlgorithmsList=C.dD,this.quantAlgorithmsList=C.A3,this.ALGORITHM_CONTROL_NAME="alg"}ngOnInit(){this.initForm(),this.listenToScriptStateChanges(),this.loadInitialData()}loadInitialData(){this.scriptFacadeService.dispatch(ot.aj.getCurrentOrLastActiveScriptDetails()),this.scriptFacadeService.scriptDetails$.pipe((0,et.T)(1),(0,Q.q)(1),(0,S.h)(e=>!!e?.algKey)).subscribe(e=>{const o=e.type;this.setInitialAlgorithmValue(o===l.Bd.PRUNING||o===l.Bd.QUANTIZATION?e.algKey:C.k2)})}setInitialAlgorithmValue(e){this.algorithmFormControl?.setValue(e,{emitEvent:!0})}initForm(){this.form=this.fb.group({[this.ALGORITHM_CONTROL_NAME]:[C.k2,a.kI.required]}),this.controlContainer?.control?.parent?.setControl(this.controlContainer.name,this.form)}listenToScriptStateChanges(){this.scriptFacadeService.scriptStatus$.pipe((0,r.t)(this)).subscribe(e=>{(0,u.A)(e)?this.form.disable():this.form.enable()})}trackByAlgorithmKey(e,o){return o.key}}).\u0275fac=function(e){return new(e||h)(t.Y36(a.qu),t.Y36(a.gN),t.Y36(T.O))},h.\u0275cmp=t.Xpm({type:h,selectors:[["ms-panel-algorithm"]],decls:11,vars:6,consts:[[1,"ms-card","algorithm-card"],[1,"heading-sub-section-title"],[3,"formGroup"],[1,"form-field-container"],["appearance","outline","subscriptSizing","dynamic"],[3,"formControlName"],["label","Pruning"],[3,"value",4,"ngFor","ngForOf","ngForTrackBy"],["label","Quantization"],[3,"value"]],template:function(e,o){1&e&&(t.TgZ(0,"mat-card",0)(1,"p",1),t._uU(2,"Algorithm"),t.qZA(),t.ynx(3,2),t.TgZ(4,"div",3)(5,"mat-form-field",4)(6,"mat-select",5)(7,"mat-optgroup",6),t.YNc(8,it,2,2,"mat-option",7),t.qZA(),t.TgZ(9,"mat-optgroup",8),t.YNc(10,nt,2,2,"mat-option",7),t.qZA()()()(),t.BQk(),t.qZA()),2&e&&(t.xp6(3),t.Q6J("formGroup",o.form),t.xp6(3),t.Q6J("formControlName",o.ALGORITHM_CONTROL_NAME),t.xp6(2),t.Q6J("ngForOf",o.pruningAlgorithmsList)("ngForTrackBy",o.trackByAlgorithmKey),t.xp6(2),t.Q6J("ngForOf",o.quantAlgorithmsList)("ngForTrackBy",o.trackByAlgorithmKey))},dependencies:[m.sg,U.a8,J.KE,R.gD,v.ey,v.Nv,a.JJ,a.JL,a.sg,a.u]}),h);var p;O=(0,A.gn)([(0,r.c)()],O);const st=["panelParameters"],at=["algorithmPanel"];function rt(i,e){1&i&&(t.ynx(0),t._UZ(1,"ms-panel-model",12),t.BQk())}let N=((p=class{constructor(e,o,s,c,g,dt){this.scriptFacadeService=e,this.fb=o,this.fileService=s,this.fileFacadeService=c,this.snackbarService=g,this.router=dt,this.isScriptActive=!1,this.isQuantAlgorithmSelected=!1}ngOnInit(){this.initForm(),this.listenToScriptStateChanges(),this.listenToAlgorithmPanelChanges()}listenToAlgorithmPanelChanges(){this.form.valueChanges.pipe((0,j.b)(50),(0,P.U)(e=>e.algorithm&&e.algorithm.alg),(0,x.x)(),(0,S.h)(e=>!!e),(0,r.t)(this)).subscribe(e=>{this.isQuantAlgorithmSelected=(0,l.t6)(e)===l.Bd.QUANTIZATION})}listenToScriptStateChanges(){this.scriptFacadeService.scriptStatus$.pipe((0,r.t)(this)).subscribe(e=>{this.isScriptActive=(0,u.A)(e),(0,u.A)(e)?this.form.disable():this.form.enable()})}initForm(){this.form=this.fb.group({algorithm:[],model:[],params:[]})}submit(){this.isQuantAlgorithmSelected?this.handleQuantizationCase():this.handlePruningCase()}handleQuantizationCase(){const{algorithm:e,model:o}=this.form.getRawValue(),{model:s}=o;if(s===f&&!this.fileService.isFileLoaded)return void this.snackbarService.showError("Please select a predefined model or upload a custom file.");let c=s===f?function b(i){let e=i.replace(/[^a-zA-Z0-9_]/g,"_");return/^[0-9_]/.test(e)&&(e="file_"+e),/.py$/.test(e)||(e+=".py"),e}(this.fileService?.file.name):s;const g={...e,params:{...this.panelParametersComponent.parametersFormatted,arch:c}};s===f?this.fileFacadeService.dispatch(E._.uploadFileAndCallScript({file:this.fileService.file,configs:g})):this.scriptFacadeService.dispatch(Z.a.callScript({configs:g}))}handlePruningCase(){const{algorithm:e}=this.form.getRawValue(),o={...e,params:this.panelParametersComponent.parametersFormatted};this.scriptFacadeService.dispatch(Z.a.callScript({configs:o}))}goToChartPage(){this.router.navigate([Y.Z.RUNNING.ROOT])}}).\u0275fac=function(e){return new(e||p)(t.Y36(T.O),t.Y36(a.qu),t.Y36(I.I),t.Y36(z.h),t.Y36(D.QD),t.Y36(M.F0))},p.\u0275cmp=t.Xpm({type:p,selectors:[["ms-machine-unlearning"]],viewQuery:function(e,o){if(1&e&&(t.Gf(st,5),t.Gf(at,5)),2&e){let s;t.iGM(s=t.CRH())&&(o.panelParametersComponent=s.first),t.iGM(s=t.CRH())&&(o.algorithmParametersComponent=s.first)}},decls:17,vars:4,consts:[[1,"heading-primary-title","title"],[1,"project-settings-wrapper",3,"formGroup"],[1,"left"],[3,"formGroup"],["formGroupName","algorithm"],["panelAlgorithm",""],[4,"ngIf"],["formArrayName","params"],["panelParameters",""],["mat-raised-button","","color","primary",3,"disabled","click"],["mat-raised-button","","color","primary",1,"ml-2",3,"click"],[1,"right"],["formGroupName","model"]],template:function(e,o){1&e&&(t.TgZ(0,"p",0),t._uU(1,"Project Settings"),t.qZA(),t.TgZ(2,"div",1)(3,"div",2),t.ynx(4,3),t._UZ(5,"ms-panel-algorithm",4,5),t.YNc(7,rt,2,0,"ng-container",6),t._UZ(8,"ms-panel-parameters",7,8),t.BQk(),t.TgZ(10,"div")(11,"button",9),t.NdJ("click",function(){return o.submit()}),t._uU(12," Run "),t.qZA(),t.TgZ(13,"button",10),t.NdJ("click",function(){return o.goToChartPage()}),t._uU(14,"View Chart"),t.qZA()()(),t.TgZ(15,"div",11),t._UZ(16,"ms-terminal"),t.qZA()()),2&e&&(t.xp6(2),t.Q6J("formGroup",o.form),t.xp6(2),t.Q6J("formGroup",o.form),t.xp6(3),t.Q6J("ngIf",o.isQuantAlgorithmSelected),t.xp6(4),t.Q6J("disabled",o.isScriptActive||o.form.invalid))},dependencies:[m.O5,H.d,V.w,$.lW,a.JL,a.sg,a.x0,a.CE,y,O],styles:[".title[_ngcontent-%COMP%]{margin-bottom:13px}.project-settings-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:20px;height:100%}.project-settings-wrapper[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]{display:flex;flex-direction:column;width:45%;gap:20px}.project-settings-wrapper[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{width:55%}"]}),p);N=(0,A.gn)([(0,r.c)()],N);const lt=[{path:"",component:N}];let ct=(()=>{var i;class e{}return(i=e).\u0275fac=function(s){return new(s||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[M.Bz.forChild(lt),M.Bz]}),e})(),mt=(()=>{var i;class e{}return(i=e).\u0275fac=function(s){return new(s||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({providers:[B],imports:[m.ez,G.m,ct]}),e})()}}]);