import{a as ie,b as ae,c as le,e as fe,f as ge}from"./chunk-DQ7AOZDA.js";import{b as te}from"./chunk-3S6QBQVM.js";import{a as ce,b as de}from"./chunk-G267DK6J.js";import{a as F,c as ue}from"./chunk-WHP5P3DQ.js";import{b as oe,e as ne,f as re}from"./chunk-W4U3FJPJ.js";import{a as me,b as pe}from"./chunk-2FJ2YO2M.js";import{b as se}from"./chunk-PSFPSLKI.js";import{a as A,b as h}from"./chunk-GMIVG7ET.js";import{h as Q,i as Y}from"./chunk-HG2O7P4S.js";import{Ab as E,Ae as ee,Bb as L,Db as R,E as b,Ea as n,Fa as p,Fb as S,Gb as y,Qa as l,R as I,Sa as r,Tb as G,Td as k,Ub as V,Ud as j,_b as D,ab as m,bb as a,bc as K,be as $,cb as u,ce as d,da as O,db as f,dd as B,eb as g,ee as z,fe as X,ge as q,ha as P,ie as v,lb as M,le as U,ne as W,oa as N,p as T,pc as w,pe as H,te as J,ub as c,wb as x,x as _,ze as Z}from"./chunk-NPZHNGVX.js";var Ce=o=>[o];function _e(o,e){o&1&&(f(0),u(1,"ms-spining-indicator",12),g())}function Se(o,e){if(o&1&&(f(0),l(1,_e,2,0,"ng-container",9),g()),o&2){let t=e.ngIf,i=M(2);n(),r("ngIf",t===i.PageKey.MODEL_TRAINING)}}function ye(o,e){if(o&1&&(m(0,"div",10)(1,"a",11),c(2,"Train models"),a(),l(3,Se,2,1,"ng-container",9),S(4,"async"),a()),o&2){let t=M();n(),r("routerLink",R(4,Ce,"/"+t.RoutesList.MODEL_TRAINING.ROOT)),n(2),r("ngIf",y(4,2,t.pageRunningScriptSpiningIndicatorService.currentRunningPage$))}}function ve(o,e){o&1&&u(0,"mat-icon",17)}function Fe(o,e){if(o&1&&(m(0,"mat-option",15),c(1),l(2,ve,1,0,"mat-icon",16),a()),o&2){let t=e.$implicit;r("value",t.name)("disabled",!t.isTrained),n(),x(" ",t.name," "),n(),r("ngIf",!t.isTrained)}}function Te(o,e){o&1&&(m(0,"mat-option",18),c(1,"No results found"),a())}function be(o,e){if(o&1&&(f(0),l(1,Fe,3,4,"mat-option",13)(2,Te,2,0,"mat-option",14),g()),o&2){let t=e.ngIf,i=M();n(),r("ngForOf",t)("ngForTrackBy",i.trackByModel),n(),r("ngIf",t.length===0)}}var s,Me=(s=class{ngOnChanges(e){e.algorithmType&&e.algorithmType.currentValue&&this.configureModels(e.algorithmType.currentValue)}get parentFormGroup(){return this.controlContainer.control}get modelFormGroup(){return this.parentFormGroup.get(this.controlKey)}get modelControl(){return this.modelFormGroup?.get(this.MODEL_CONTROL_NAME)}constructor(e,t,i,C){this.controlContainer=e,this.modelsFacadeService=t,this.scriptFacadeService=i,this.pageRunningScriptSpiningIndicatorService=C,this.controlKey="",this.isTrainModelsPageRouteVisible=!0,this.PageKey=ae,this.RoutesList=B,this.searchModel=new v,this.models=[],this.MODEL_CONTROL_NAME="model"}ngOnInit(){this.initializeForm(),this.listenToScriptStateChanges(),this.listenToSearchModelValueChanges(),this.configureModels(this.algorithmType)}configureModels(e){e&&(this.getModelsByTypeSubscription?.unsubscribe(),this.getModelsByTypeSubscription=this.subscribeToModelsListChanges(e),this.modelsFacadeService.dispatch(F.getModelsList({algorithmType:e})),this.modelsFacadeService.dispatch(F.getCurrentOrPreviousSelectedModel({algorithmType:e})))}listenToCurrentModelChanges(){this.modelsFacadeService.currentModel$.pipe(h(this)).subscribe(e=>{if(ne(e))return;let t=this.models.find(i=>i.name===e);t&&t.isTrained&&this.modelControl?.patchValue(e)})}subscribeToModelsListChanges(e){let t=!1;return this.modelsFacadeService.getModelsByType(e).pipe(b(i=>!re(i)),_(i=>[...i].sort((C,he)=>Number(he.isTrained)-Number(C.isTrained)))).subscribe(i=>{this.models=i,this.searchModel.setValue(""),t||(this.listenToCurrentModelChanges(),t=!0)})}initializeForm(){this.parentFormGroup.addControl(this.controlKey,new q({[this.MODEL_CONTROL_NAME]:new v("",$.required)}))}listenToScriptStateChanges(){this.scriptFacadeService.scriptStatus$.pipe(h(this)).subscribe(e=>{oe(e)?this.modelFormGroup.disable():this.modelFormGroup.enable()})}listenToSearchModelValueChanges(){this.filteredModels=this.searchModel.valueChanges.pipe(h(this),I(""),_(e=>this.filterModels(e)))}filterModels(e){let t=e.toLowerCase();return this.models.filter(i=>i.name.toLowerCase().includes(t))}trackByModel(e,t){return t.name}ngOnDestroy(){this.parentFormGroup.removeControl(this.controlKey)}},s.\u0275fac=function(t){return new(t||s)(p(d),p(ue),p(se),p(le))},s.\u0275cmp=P({type:s,selectors:[["ms-panel-model"]],inputs:{controlKey:"controlKey",algorithmType:"algorithmType",isTrainModelsPageRouteVisible:"isTrainModelsPageRouteVisible"},standalone:!0,features:[E([],[{provide:d,useFactory:()=>O(d,{skipSelf:!0})}]),N,L],decls:13,vars:6,consts:[[1,"ms-card","model-card"],[1,"panel-title-wrapper"],[1,"heading-sub-section-title"],["class","train-models",4,"ngIf"],[1,"form-field-container",3,"formGroupName"],["appearance","outline","subscriptSizing","dynamic"],["formControlName","model","placeholder","Select a model..."],["label","Predefined Models"],[3,"formControl"],[4,"ngIf"],[1,"train-models"],[3,"routerLink"],[1,"ml-2"],[3,"value","disabled",4,"ngFor","ngForOf","ngForTrackBy"],["disabled","",4,"ngIf"],[3,"value","disabled"],["class","mat-error","fontSet","ms","fontIcon","icon-X",4,"ngIf"],["fontSet","ms","fontIcon","icon-X",1,"mat-error"],["disabled",""]],template:function(t,i){t&1&&(m(0,"mat-card",0)(1,"div",1)(2,"div",2),c(3,"Model"),a(),l(4,ye,5,6,"div",3),a(),m(5,"div",4)(6,"mat-form-field",5)(7,"mat-select",6)(8,"mat-optgroup",7)(9,"mat-option"),u(10,"ngx-mat-select-search",8),a(),l(11,be,3,3,"ng-container",9),S(12,"async"),a()()()()()),t&2&&(n(4),r("ngIf",i.isTrainModelsPageRouteVisible),n(),r("formGroupName",i.controlKey),n(5),r("formControl",i.searchModel),n(),r("ngIf",y(12,4,i.filteredModels)))},dependencies:[J,z,X,U,H,W,pe,me,Y,Q,de,ce,j,k,ee,Z,K,G,V,D,ge,fe,w,te,ie],styles:[".panel-title-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:12px}.panel-title-wrapper[_ngcontent-%COMP%]   .train-models[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}"]}),s);Me=T([A()],Me);export{Me as a};
