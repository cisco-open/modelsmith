import{b as Me,c as he,d as v}from"./chunk-5ZLPWT2K.js";import{a as oe,b as se,c as me}from"./chunk-2YCNMDJU.js";import{b as ie}from"./chunk-6OG4GIDG.js";import{a as ce,b as ue}from"./chunk-KECYA32T.js";import{a as de,b as pe}from"./chunk-CFYL7YUG.js";import{a as fe}from"./chunk-UVRKHTIO.js";import{b as ne}from"./chunk-C4NPICWQ.js";import{c as re,d as ae}from"./chunk-XX6ZYDLH.js";import{b as le}from"./chunk-REE2RBO3.js";import{a as A,b as h}from"./chunk-V63QBU7B.js";import{h as Y,i as Z}from"./chunk-GZP2I6OY.js";import{$a as L,$b as w,Ab as E,Ae as ee,Bb as x,Be as te,Cb as G,D as F,Ea as n,Eb as V,Fa as p,Gb as C,Hb as S,Q as T,Qa as m,Sa as c,Td as k,Ud as B,Ya as d,Yb as D,_a as N,ab as s,bb as r,be as $,ca as b,cb as M,ce as f,dd as j,ee as z,fe as q,ga as P,ge as U,ie as _,lb as I,me as W,na as O,oc as K,oe as X,p as y,qe as H,te as J,ub as u,ue as Q,w as g,wb as R}from"./chunk-2CPYVQID.js";var Se=(o,e)=>e.name,_e=o=>[o];function ve(o,e){o&1&&M(0,"ms-spining-indicator",10)}function ye(o,e){if(o&1&&(s(0,"div",3)(1,"a",9),u(2,"Train models"),r(),E(3),C(4,"async"),m(5,ve,1,0,"ms-spining-indicator",10),r()),o&2){let t=I();n(),c("routerLink",V(4,_e,"/"+t.RoutesList.MODEL_TRAINING.ROOT));let i=S(4,2,t.pageRunningScriptSpiningIndicatorService.currentRunningPageInfo$);n(4),d((i==null?null:i.page)===t.PageKey.MODEL_TRAINING?5:-1)}}function Fe(o,e){o&1&&M(0,"mat-icon",13)}function Te(o,e){if(o&1&&(s(0,"mat-option",11),u(1),m(2,Fe,1,0,"mat-icon",13),r()),o&2){let t=e.$implicit;c("value",t.name)("disabled",!t.isTrained),n(),R(" ",t.name," "),n(),d(t.isTrained?-1:2)}}function be(o,e){o&1&&(s(0,"mat-option",12),u(1,"No results found"),r())}function Pe(o,e){if(o&1&&(N(0,Te,3,4,"mat-option",11,Se),m(2,be,2,0,"mat-option",12)),o&2){let t=e;L(t),n(2),d(t.length===0?2:-1)}}var a,ge=(a=class{ngOnChanges(e){e.algorithmType&&e.algorithmType.currentValue&&this.configureModels(e.algorithmType.currentValue)}get parentFormGroup(){return this.controlContainer.control}get modelFormGroup(){return this.parentFormGroup.get(this.controlKey)}get modelControl(){return this.modelFormGroup?.get(this.MODEL_CONTROL_NAME)}constructor(e,t,i,l){this.controlContainer=e,this.modelsFacadeService=t,this.scriptFacadeService=i,this.pageRunningScriptSpiningIndicatorService=l,this.controlKey="",this.isTrainModelsPageRouteVisible=!0,this.PageKey=se,this.RoutesList=j,this.searchModel=new _,this.models=[],this.MODEL_CONTROL_NAME="model"}ngOnInit(){this.initializeForm(),this.listenToScriptStateChanges(),this.listenToSearchModelValueChanges(),this.configureModels(this.algorithmType)}configureModels(e){e&&(this.getModelsByTypeSubscription?.unsubscribe(),this.getModelsByTypeSubscription=this.subscribeToModelsListChanges(e),this.modelsFacadeService.dispatch(v.getModelsList({algorithmType:e})),this.modelsFacadeService.dispatch(v.getCurrentOrPreviousSelectedModel({algorithmType:e})))}listenToCurrentModelChanges(){this.modelsFacadeService.currentModel$.pipe(h(this)).subscribe(e=>{if(re(e))return;let t=this.models.find(i=>i.name===e);t&&t.isTrained&&this.modelControl?.patchValue(e)})}subscribeToModelsListChanges(e){let t=!1;return this.modelsFacadeService.getModelsByType(e).pipe(F(i=>!ae(i)),g(i=>[...i].sort((l,Ce)=>Number(Ce.isTrained)-Number(l.isTrained)))).subscribe(i=>{this.models=i,this.searchModel.setValue(""),t||(this.listenToCurrentModelChanges(),t=!0)})}initializeForm(){this.parentFormGroup.addControl(this.controlKey,new U({[this.MODEL_CONTROL_NAME]:new _("",$.required)}))}listenToScriptStateChanges(){this.scriptFacadeService.scriptStatus$.pipe(h(this)).subscribe(e=>{ne(e)?this.modelFormGroup.disable():this.modelFormGroup.enable()})}listenToSearchModelValueChanges(){this.filteredModels=this.searchModel.valueChanges.pipe(h(this),T(""),g(e=>this.filterModels(e)))}filterModels(e){let t=e.toLowerCase();return this.models.filter(i=>i.name.toLowerCase().includes(t))}ngOnDestroy(){this.parentFormGroup.removeControl(this.controlKey)}},a.\u0275fac=function(t){return new(t||a)(p(f),p(fe),p(le),p(me))},a.\u0275cmp=P({type:a,selectors:[["ms-panel-model"]],inputs:{controlKey:"controlKey",algorithmType:"algorithmType",isTrainModelsPageRouteVisible:"isTrainModelsPageRouteVisible"},standalone:!0,features:[x([],[{provide:f,useFactory:()=>b(f,{skipSelf:!0})}]),O,G],decls:13,vars:6,consts:[[1,"ms-card","model-card"],[1,"panel-title-wrapper"],[1,"heading-sub-section-title"],[1,"train-models"],[1,"form-field-container",3,"formGroupName"],["appearance","outline","subscriptSizing","dynamic"],["formControlName","model","placeholder","Select a model..."],[3,"formControl"],["label","Predefined Models"],[3,"routerLink"],[1,"ml-2"],[3,"value","disabled"],["disabled",""],["fontSet","ms","fontIcon","icon-X",1,"mat-error"]],template:function(t,i){if(t&1&&(s(0,"mat-card",0)(1,"div",1)(2,"div",2),u(3,"Model"),r(),m(4,ye,6,6,"div",3),r(),s(5,"div",4)(6,"mat-form-field",5)(7,"mat-select",6)(8,"mat-option"),M(9,"ngx-mat-select-search",7),r(),s(10,"mat-optgroup",8),m(11,Pe,3,1),C(12,"async"),r()()()()()),t&2){let l;n(4),d(i.isTrainModelsPageRouteVisible?4:-1),n(),c("formGroupName",i.controlKey),n(4),c("formControl",i.searchModel),n(2),d((l=S(12,4,i.filteredModels))?11:-1,l)}},dependencies:[w,D,J,z,q,Q,W,H,X,pe,de,Z,Y,ue,ce,B,k,te,ee,he,Me,K,ie,oe],styles:[".panel-title-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:12px}.panel-title-wrapper[_ngcontent-%COMP%]   .train-models[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}"]}),a);ge=y([A()],ge);export{ge as a};
