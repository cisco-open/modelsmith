import{a as ie}from"./chunk-QOYY3LFK.js";import{a as le}from"./chunk-DOUFOPUV.js";import{a as se,b as te}from"./chunk-A77X2NVE.js";import{a as J,b as $}from"./chunk-THWFY62J.js";import{c as K,f as W,g as X}from"./chunk-XX6ZYDLH.js";import{a as Y,d as Z}from"./chunk-DE2VZEAU.js";import{n as ee}from"./chunk-2NQ5HBSG.js";import{a as E,b as g}from"./chunk-HYZKEUDG.js";import"./chunk-RI64VF5Y.js";import{a as Q,d as N,h as L,j as q,k as G}from"./chunk-HDQHN5AB.js";import{Be as P,Cb as F,Ce as U,D as y,Ea as f,Fa as c,J as C,Qa as M,Sa as w,Ya as b,ab as o,ac as A,ae as I,bb as n,cb as s,e as v,fe as k,ga as S,gb as u,jb as p,je as O,lb as _,ne as V,oa as l,p as T,pa as m,qb as D,rb as x,sb as H,ub as d,ue as z,ve as B,ye as j,ze as R}from"./chunk-KEE6Z3KT.js";var oe=v(se()),ne=v(le());var me=["terminalHistory"];function ce(h,e){if(h&1){let t=u();o(0,"mat-icon",16),p("click",function(){l(t);let a=_();return m(a.disposeSearch())}),d(1," close "),n()}}function pe(h,e){h&1&&(o(0,"mat-icon",8),d(1,"search"),n())}var r,re=(r=class{constructor(e,t,i){this.dialogConfig=e,this.terminalFacadeService=t,this.terminalStylesService=i,this.searchFormControl=new O(""),this.fitAddon=new oe.FitAddon,this.searchAddon=new ne.SearchAddon}ngOnInit(){this.initializeTerminal(),this.loadData(),this.listenToSearchFormControlChanges(),W()}ngAfterViewInit(){this.adjustHeightToParent(),this.fitTerminalToContainer()}loadData(){this.terminalFacadeService.dispatch(ie.getTerminalHistory()),this.terminalFacadeService.terminalHistory.pipe(g(this)).subscribe(e=>{e&&this.writeToTerminal(e)})}initializeTerminal(){this.terminal=this.terminalStylesService.createTerminalInstance({cursorBlink:!1,disableStdin:!0}),this.terminal.loadAddon(this.fitAddon),this.terminal.loadAddon(this.searchAddon),this.terminal.open(this.terminalHistoryDiv.nativeElement),this.setupResizeObserver()}listenToSearchFormControlChanges(){this.searchFormControl.valueChanges.pipe(g(this),C(300),y(e=>!K(e))).subscribe(e=>{this.search(e)})}search(e){this.searchAddon.findNext(e,{decorations:this.terminalStylesService.getSearchDecorationOptions()})}disposeSearch(){this.searchAddon.clearDecorations(),this.searchFormControl.setValue("")}writeToTerminal(e){let t=this.filterClearCommand(e);this.terminal.write(t)}filterClearCommand(e){let t=/\x1B\[H\x1B\[J/g;return e.replace(t,"")}setupResizeObserver(){this.resizeObserver&&this.resizeObserver.disconnect(),this.resizeObserver=new ResizeObserver(()=>this.fitTerminalToContainer()),this.resizeObserver.observe(this.terminalHistoryDiv.nativeElement)}fitTerminalToContainer(){this.fitAddon.fit()}adjustHeightToParent(){let e=this.terminalHistoryDiv.nativeElement.parentElement.parentElement.parentElement.parentElement;if(e){let t;t=e.offsetHeight-280,this.terminalHistoryDiv.nativeElement.style.height=`${t}px`}}scrollToTopTerminal(){this.terminal.scrollToTop()}scrollToBottomTerminal(){this.terminal.scrollToBottom()}ngOnDestroy(){this.resizeObserver?.disconnect(),X()}},r.\u0275fac=function(t){return new(t||r)(c(Y),c(ee),c(te))},r.\u0275cmp=S({type:r,selectors:[["ms-terminal-messages-history-dialog"]],viewQuery:function(t,i){if(t&1&&D(me,7),t&2){let a;x(a=H())&&(i.terminalHistoryDiv=a.first)}},standalone:!0,features:[F],decls:19,vars:2,consts:[["terminalHistory",""],[1,"ms-terminal-wrapper"],[1,"top-terminal-section"],[1,"left"],[1,"form-field-container"],["subscriptSizing","dynamic"],["matInput","","placeholder","Search terminal messages",3,"formControl"],["matSuffix","",1,"mat-error","scale-on-hover"],["matSuffix","",1,"mat-primary"],[1,"right"],["mat-icon-button","","color","primary","matTooltip","Scroll to top",3,"click"],["fontSet","ms","fontIcon","icon-ArrowUp"],["mat-icon-button","","color","primary","matTooltip","Scroll to bottom",3,"click"],["fontSet","ms","fontIcon","icon-ArrowDown"],[1,"terminal"],[1,"terminal-wrapper"],["matSuffix","",1,"mat-error","scale-on-hover",3,"click"]],template:function(t,i){if(t&1){let a=u();o(0,"ms-dialog")(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"mat-label"),d(6,"Search"),n(),o(7,"mat-form-field",5),s(8,"input",6),M(9,ce,2,0,"mat-icon",7)(10,pe,2,0,"mat-icon",8),n()()(),o(11,"div",9)(12,"button",10),p("click",function(){return l(a),m(i.scrollToTopTerminal())}),s(13,"mat-icon",11),n(),o(14,"button",12),p("click",function(){return l(a),m(i.scrollToBottomTerminal())}),s(15,"mat-icon",13),n()()(),o(16,"div",14),s(17,"div",15,0),n()()()}t&2&&(f(8),w("formControl",i.searchFormControl),f(),b(i.searchFormControl.value?9:10))},dependencies:[A,Z,U,P,R,j,z,I,k,B,V,G,q,L,Q,N,$,J],styles:[`.ms-terminal-wrapper{overflow-x:auto}.ms-terminal-wrapper .terminal-wrapper{border:10px solid var(--terminal-color);background-color:var(--terminal-color);border-radius:10px}.ms-terminal-wrapper .xterm-viewport{overflow-y:auto!important}.ms-terminal-wrapper .top-terminal-section{display:flex;justify-content:space-between;margin-bottom:10px}.ms-terminal-wrapper .top-terminal-section .right{display:flex;align-items:flex-end}
`],encapsulation:2}),r);re=T([E()],re);export{re as MsTerminalMessagesHistoryDialogComponent};
