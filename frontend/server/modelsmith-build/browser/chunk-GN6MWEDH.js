import{a as te}from"./chunk-H3SVRTFN.js";import{a as se,b as le,c as me}from"./chunk-HTQHSSGZ.js";import{a as J,b as $}from"./chunk-CXMHZ5XC.js";import{c as K,f as W,g as X}from"./chunk-XX6ZYDLH.js";import{a as Y,c as Z}from"./chunk-5MCZHTBZ.js";import{n as ee}from"./chunk-XSOJ6DN4.js";import{a as E,b as v}from"./chunk-KP473PLS.js";import"./chunk-I333ACNB.js";import{a as Q,d as N,h as P,j as q,k as G}from"./chunk-LCKMIOUI.js";import{$a as o,Bb as H,D as C,Da as f,Ea as u,J as F,Pa as M,Ra as w,Xa as S,Zd as k,_b as A,ab as n,bb as s,ce as B,e as h,fb as g,ga as y,ge as I,ib as c,je as O,kb as b,oa as l,p as T,pa as m,pb as _,qb as D,qe as V,rb as x,re as z,tb as d,ue as R,ve as j,xe as L,ye as U}from"./chunk-MVLCGSW5.js";var re=h(se()),oe=h(le()),ne=h(me());var ce=["terminalHistory"];function de(p,e){if(p&1){let t=g();o(0,"mat-icon",16),c("click",function(){l(t);let a=b();return m(a.disposeSearch())}),d(1," close "),n()}}function pe(p,e){p&1&&(o(0,"mat-icon",8),d(1,"search"),n())}var i,ie=(i=class{constructor(e,t){this.dialogConfig=e,this.terminalFacadeService=t,this.searchFormControl=new I(""),this.terminal=new ne.Terminal({theme:{background:"#D0D4D9",foreground:"#000000",cursor:"#000000"},cursorBlink:!1,disableStdin:!0,allowProposedApi:!0}),this.fitAddon=new re.FitAddon,this.searchAddon=new oe.SearchAddon}ngOnInit(){this.initializeTerminal(),this.loadData(),this.listenToSearchFormControlChanges(),W()}ngAfterViewInit(){this.adjustHeightToParent(),this.fitTerminalToContainer()}loadData(){this.terminalFacadeService.dispatch(te.getTerminalHistory()),this.terminalFacadeService.terminalHistory.pipe(v(this)).subscribe(e=>{e&&this.writeToTerminal(e)})}initializeTerminal(){this.terminal.loadAddon(this.fitAddon),this.terminal.loadAddon(this.searchAddon),this.terminal.open(this.terminalHistoryDiv.nativeElement),this.setupResizeObserver()}listenToSearchFormControlChanges(){this.searchFormControl.valueChanges.pipe(v(this),F(300),C(e=>!K(e))).subscribe(e=>{this.search(e)})}search(e){this.searchAddon.findNext(e,{decorations:{matchBackground:"#FFFF00",matchBorder:"#FFFF00",matchOverviewRuler:"#FFFF00",activeMatchBackground:"#FFFF00",activeMatchBorder:"#FFFF00",activeMatchColorOverviewRuler:"#FFFF00"}})}disposeSearch(){this.searchAddon.clearDecorations(),this.searchFormControl.setValue("")}writeToTerminal(e){let t=this.filterClearCommand(e);this.terminal.write(t)}filterClearCommand(e){let t=/\x1B\[H\x1B\[J/g;return e.replace(t,"")}setupResizeObserver(){this.resizeObserver&&this.resizeObserver.disconnect(),this.resizeObserver=new ResizeObserver(()=>this.fitTerminalToContainer()),this.resizeObserver.observe(this.terminalHistoryDiv.nativeElement)}fitTerminalToContainer(){this.fitAddon.fit()}adjustHeightToParent(){let e=this.terminalHistoryDiv.nativeElement.parentElement.parentElement.parentElement.parentElement;if(e){let t;t=e.offsetHeight-280,this.terminalHistoryDiv.nativeElement.style.height=`${t}px`}}scrollToTopTerminal(){this.terminal.scrollToTop()}scrollToBottomTerminal(){this.terminal.scrollToBottom()}ngOnDestroy(){this.resizeObserver?.disconnect(),X()}},i.\u0275fac=function(t){return new(t||i)(u(Y),u(ee))},i.\u0275cmp=y({type:i,selectors:[["ms-terminal-messages-history-dialog"]],viewQuery:function(t,r){if(t&1&&_(ce,7),t&2){let a;D(a=x())&&(r.terminalHistoryDiv=a.first)}},standalone:!0,features:[H],decls:19,vars:2,consts:[["terminalHistory",""],[1,"ms-terminal-wrapper"],[1,"top-terminal-section"],[1,"left"],[1,"form-field-container"],["subscriptSizing","dynamic"],["matInput","","placeholder","Search terminal messages",3,"formControl"],["matSuffix","",1,"mat-error","scale-on-hover"],["matSuffix","",1,"mat-primary"],[1,"right"],["mat-icon-button","","color","primary","matTooltip","Scroll to top",3,"click"],["fontSet","ms","fontIcon","icon-ArrowUp"],["mat-icon-button","","color","primary","matTooltip","Scroll to bottom",3,"click"],["fontSet","ms","fontIcon","icon-ArrowDown"],[1,"terminal"],[1,"terminal-wrapper"],["matSuffix","",1,"mat-error","scale-on-hover",3,"click"]],template:function(t,r){if(t&1){let a=g();o(0,"ms-dialog")(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"mat-label"),d(6,"Search"),n(),o(7,"mat-form-field",5),s(8,"input",6),M(9,de,2,0,"mat-icon",7)(10,pe,2,0,"mat-icon",8),n()()(),o(11,"div",9)(12,"button",10),c("click",function(){return l(a),m(r.scrollToTopTerminal())}),s(13,"mat-icon",11),n(),o(14,"button",12),c("click",function(){return l(a),m(r.scrollToBottomTerminal())}),s(15,"mat-icon",13),n()()(),o(16,"div",14),s(17,"div",15,0),n()()()}t&2&&(f(8),w("formControl",r.searchFormControl),f(),S(r.searchFormControl.value?9:10))},dependencies:[A,Z,U,L,j,R,V,k,B,z,O,G,q,P,Q,N,$,J],styles:[`.ms-terminal-wrapper{overflow-x:auto}.ms-terminal-wrapper .terminal-wrapper{border:10px solid var(--terminal-color);background-color:var(--terminal-color);border-radius:10px}.ms-terminal-wrapper .xterm-viewport{overflow-y:auto!important}.ms-terminal-wrapper .top-terminal-section{display:flex;justify-content:space-between;margin-bottom:10px}.ms-terminal-wrapper .top-terminal-section .right{display:flex;align-items:flex-end}
`],encapsulation:2}),i);ie=T([E()],ie);export{ie as MsTerminalMessagesHistoryDialogComponent};
