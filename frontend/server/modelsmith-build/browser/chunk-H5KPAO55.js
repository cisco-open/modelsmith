import{a as E,b as Be}from"./chunk-XCVN6GNY.js";import{b as xe}from"./chunk-LRK34XDC.js";import{a as We,b as Le,c as Ne}from"./chunk-VLO6NL53.js";import{a as Fe,b as ke}from"./chunk-GWFXRHCV.js";import{c as De}from"./chunk-XX6ZYDLH.js";import{d as Oe}from"./chunk-QXM4YYRP.js";import{a as Pe,b as I}from"./chunk-3IJULEGV.js";import{a as P,b as M}from"./chunk-QJ55TOIV.js";import{b as Me,s as _e}from"./chunk-CYUWMGXJ.js";import{a as ge,d as be,h as Se,i as Ce,j as we,k as ye}from"./chunk-HULQWYRR.js";import{$a as n,Ab as S,Ca as $,D as L,Da as u,Ea as f,Hb as le,I as N,J as Q,Ma as J,Pa as C,Ra as h,Rb as ae,Tb as ce,Vb as me,Xd as de,Z as U,Zb as k,a as W,ab as l,ae as ue,ba as q,bb as m,cb as Z,db as ee,e as A,eb as te,ee as fe,f as V,fb as F,ga as b,he,ia as G,ib as a,kb as w,oa as p,oe as ve,p as _,pa as d,pb as oe,pe as Te,qb as ie,rb as ne,rc as pe,sb as z,sc as H,se as x,tb as y,te as D,ub as re,vc as X,ve as O,wa as K,wc as j,we as B,xa as c,yc as Y,zb as se}from"./chunk-DL2LTWBU.js";var Ee=A(We()),Re=A(Le()),Ae=A(Ne());var Ue=["terminal"],T,Ie=(T=class{constructor(e){this.terminalWebSocketService=e,this.fitAddon=new Ee.FitAddon,this.searchAddon=new Re.SearchAddon}ngOnInit(){this.initializeTerminal(),this.subscribeToWebSocketMessages()}ngAfterViewInit(){this.adjustHeightToParent(),this.fitTerminalToContainer()}initializeTerminal(){this.terminal=new Ae.Terminal(W({cursorBlink:!0,theme:{background:"#D0D4D9",foreground:"#000000",cursor:"#000000",selectionBackground:"#FFDD00",selectionForeground:"#000000"},allowProposedApi:!0},this.options)),this.terminal.loadAddon(this.fitAddon),this.terminal.loadAddon(this.searchAddon),this.terminal.open(this.terminalDiv.nativeElement),this.setupResizeObserver(),this.terminal.onData(e=>{this.terminalWebSocketService.sendMessage(e)})}subscribeToWebSocketMessages(){this.terminalWebSocketService.messages$.pipe(M(this)).subscribe(e=>{this.terminal.write(e)})}setupResizeObserver(){this.resizeObserver&&this.resizeObserver.disconnect(),this.resizeObserver=new ResizeObserver(()=>this.fitTerminalToContainer()),this.resizeObserver.observe(this.terminalDiv.nativeElement)}fitTerminalToContainer(){this.fitAddon.fit()}adjustHeightToParent(){}ngOnDestroy(){this.resizeObserver?.disconnect(),this.terminal.dispose()}search(e){this.searchAddon.findNext(e,{decorations:{matchBackground:"#FFFF00",matchBorder:"#FFFF00",matchOverviewRuler:"#FFFF00",activeMatchBackground:"#FFFF00",activeMatchBorder:"#FFFF00",activeMatchColorOverviewRuler:"#FFFF00"}})}clearSearch(){this.searchAddon.clearDecorations()}clearTerminal(){this.terminal.clear()}scrollToTop(){this.terminal.scrollToTop()}scrollToBottom(){this.terminal.scrollToBottom()}},T.\u0275fac=function(r){return new(r||T)(f(E))},T.\u0275cmp=b({type:T,selectors:[["ms-terminal-xterm"]],viewQuery:function(r,t){if(r&1&&oe(Ue,7),r&2){let o;ie(o=ne())&&(t.terminalDiv=o.first)}},inputs:{options:"options"},standalone:!0,features:[se([I,Be]),S],decls:3,vars:0,consts:[["terminal",""],[1,"terminal"],[1,"terminal-wrapper"]],template:function(r,t){r&1&&(n(0,"div",1),m(1,"div",2,0),l())}}),T);Ie=_([P({})],Ie);var Ve=pe("tooltipState",[j("hidden",X({opacity:0,transform:"scale(0.9)"})),j("visible",X({opacity:1,transform:"scale(1)"})),Y("hidden => visible",H("150ms ease-in")),Y("visible => hidden",H("150ms ease-out"))]);function Ke(i,e){i&1&&te(0)}function $e(i,e){if(i&1&&(Z(0),n(1,"div",5),C(2,Ke,1,0,"ng-container",6),l(),ee()),i&2){let r=w();u(2),h("ngTemplateOutlet",r.contentTemplate)}}function Je(i,e){if(i&1){let r=F();n(0,"div",7)(1,"button",8),a("click",function(){p(r);let o=w();return d(o.triggerClose())}),m(2,"mat-icon",9),l()()}}var ze=(()=>{let e=class e{constructor(){this.position="bottom",this.showCloseButton=!1,this.state="hidden",this.close=new c}triggerClose(){this.state="hidden",setTimeout(()=>this.close.emit(),150)}};e.\u0275fac=function(o){return new(o||e)},e.\u0275cmp=b({type:e,selectors:[["ms-tooltip-panel"]],inputs:{contentTemplate:"contentTemplate",position:"position",showCloseButton:"showCloseButton",state:"state"},outputs:{close:"close"},standalone:!0,features:[S],decls:5,vars:4,consts:[[1,"tooltip-container",3,"ngClass"],[1,"tooltip-arrow"],[1,"tooltip-wrapper"],[4,"ngIf"],["class","close-button",4,"ngIf"],[1,"tooltip-content"],[4,"ngTemplateOutlet"],[1,"close-button"],["mat-icon-button","",3,"click"],["fontSet","ms","fontIcon","icon-X",1,"mat-error","size-20"]],template:function(o,s){o&1&&(n(0,"div",0),m(1,"div",1),n(2,"div",2),C(3,$e,3,1,"ng-container",3)(4,Je,3,0,"div",4),l()()),o&2&&(h("ngClass",s.position)("@tooltipState",s.state),u(3),h("ngIf",s.contentTemplate),u(),h("ngIf",s.showCloseButton))},dependencies:[k,ae,ce,me,B,O,D,x],styles:[".tooltip-container[_ngcontent-%COMP%]{position:relative;background-color:var(--tooltip);color:var(--terminal-color);border-radius:6px;box-shadow:0 4px 8px #0000001a}.tooltip-wrapper[_ngcontent-%COMP%]{display:flex;padding:2px 6px}.tooltip-arrow[_ngcontent-%COMP%]{position:absolute;width:0;height:0;border-style:solid}.tooltip-content[_ngcontent-%COMP%]{padding:12px}.tooltip-container.top[_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%]{bottom:-10px;left:50%;transform:translate(-50%);border-width:10px 10px 0 10px;border-color:var(--tooltip) transparent transparent transparent}.tooltip-container.bottom[_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%]{top:-10px;left:50%;transform:translate(-50%);border-width:0 10px 10px 10px;border-color:transparent transparent var(--tooltip) transparent}.tooltip-container.left[_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%]{right:-10px;top:50%;transform:translateY(-50%);border-width:10px 0 10px 10px;border-color:transparent transparent transparent var(--tooltip)}.tooltip-container.right[_ngcontent-%COMP%]   .tooltip-arrow[_ngcontent-%COMP%]{left:-10px;top:50%;transform:translateY(-50%);border-width:10px 10px 10px 0;border-color:transparent var(--tooltip) transparent transparent}.close-button[_ngcontent-%COMP%]{right:0;top:-2;position:absolute}"],data:{animation:[Ve]}});let i=e;return i})();var He=(()=>{let e=class e{constructor(t,o,s){this.overlay=t,this.viewContainerRef=o,this.elementRef=s,this.position="bottom",this.showCloseButton=!1,this.closeOnBackdropClick=!0,this.allowCloseOnEscPress=!0,this.freezePageScroll=!0,this.closed=new c,this.overlayRef=null}onClick(){this.overlayRef?this.closePanel():this.openPanel()}handleEscKey(t){this.allowCloseOnEscPress&&this.closePanel()}openPanel(){let t=this.getPositionStrategy();this.overlayRef=this.overlay.create({positionStrategy:t});let o=new Me(ze,this.viewContainerRef),v=this.overlayRef.attach(o).instance;v.contentTemplate=this.contentTemplate,v.position=this.position,v.showCloseButton=this.showCloseButton,this.freezePageScroll&&document.body.classList.add("no-scroll"),setTimeout(()=>{v.state="visible"},0),v.close.subscribe(()=>{this.closePanel()}),this.closeOnBackdropClick&&(this.backdropClickSubscription=this.overlayRef.backdropClick().subscribe(()=>{this.closePanel()}))}closePanel(){if(this.overlayRef){let t=this.overlayRef.overlayElement.querySelector("ms-tooltip-panel");t&&(t.state="hidden",setTimeout(()=>{this.overlayRef?.detach(),this.overlayRef=null,this.closed.emit()},150)),this.freezePageScroll&&document.body.classList.remove("no-scroll"),this.backdropClickSubscription&&this.backdropClickSubscription.unsubscribe()}}getPositionStrategy(){let t={top:{originX:"center",originY:"top",overlayX:"center",overlayY:"bottom"},bottom:{originX:"center",originY:"bottom",overlayX:"center",overlayY:"top"},left:{originX:"start",originY:"center",overlayX:"end",overlayY:"center"},right:{originX:"end",originY:"center",overlayX:"start",overlayY:"center"}};return this.overlay.position().flexibleConnectedTo(this.elementRef).withPositions([t[this.position]])}ngOnDestroy(){this.overlayRef&&this.overlayRef.dispose(),this.backdropClickSubscription&&this.backdropClickSubscription.unsubscribe()}};e.\u0275fac=function(o){return new(o||e)(f(_e),f(J),f(K))},e.\u0275dir=G({type:e,selectors:[["","msTooltipPanel",""]],hostBindings:function(o,s){o&1&&a("click",function(){return s.onClick()})("keydown.escape",function(Ye){return s.handleEscKey(Ye)},!1,$)},inputs:{contentTemplate:[0,"msTooltipPanel","contentTemplate"],position:"position",showCloseButton:"showCloseButton",closeOnBackdropClick:"closeOnBackdropClick",allowCloseOnEscPress:"allowCloseOnEscPress",freezePageScroll:"freezePageScroll"},outputs:{closed:"closed"},exportAs:["msTooltipPanel"],standalone:!0});let i=e;return i})();var Xe=(()=>{let e=class e{constructor(t){this.dialogService=t}openFullScreenDialog(t){return V(this,null,function*(){if(t)return;let{MsTerminalFullscreenDialogComponent:o}=yield import("./chunk-ROZWTIHH.js");document.body.classList.add("no-scroll"),this.dialogService.open(o,{showHeader:!1,showFooter:!1,showSaveButton:!1,width:"100vw",height:"100vh"}).afterClosed().pipe(N(1)).subscribe(()=>{document.body.classList.remove("no-scroll")})})}openMessagesHistoryDialog(){return V(this,null,function*(){let{MsTerminalMessagesHistoryDialogComponent:t}=yield import("./chunk-TUV33PUP.js");this.dialogService.open(t,{title:"Terminal history",showSaveButton:!1,width:"60vw",height:"75vh"})})}};e.\u0275fac=function(o){return new(o||e)(q(Oe))},e.\u0275prov=U({token:e,factory:e.\u0275fac,providedIn:"root"});let i=e;return i})();function et(i,e){if(i&1&&(n(0,"div",14)(1,"mat-label"),y(2," Search... "),l(),n(3,"mat-form-field",15),m(4,"input",16)(5,"mat-icon",17),l()()),i&2){let r=w();u(4),h("formControl",r.searchFormControl)}}var g,je=(g=class{constructor(e,r,t){this.scriptFacadeService=e,this.terminalWebSocketService=r,this.terminalDialogService=t,this.isFullscreen=!1,this.isScriptActive=!1,this.clearTerminal=new c,this.scrollToTopTerminal=new c,this.scrollToBottomTerminal=new c,this.searchTerminal=new c,this.disposeSearch=new c,this.exitFullscreen=new c,this.searchFormControl=new fe("")}ngOnInit(){this.listenToScriptStateChanges(),this.listenToSearchFormControlChanges()}clearTerminalScreen(){this.terminalWebSocketService.clearScreen()}listenToSearchFormControlChanges(){this.searchFormControl.valueChanges.pipe(M(this),Q(300),L(e=>!De(e))).subscribe(e=>{this.searchTerminal.emit(e)})}listenToScriptStateChanges(){this.scriptFacadeService.scriptStatus$.pipe(M(this)).subscribe(e=>{this.isScriptActive=xe(e)})}ctaStopScript(){this.scriptFacadeService.dispatch(Pe.stopScript())}openTerminalMessagesHistoryDialog(){this.terminalDialogService.openMessagesHistoryDialog()}openFullScreenMode(){if(this.isFullscreen){this.exitFullscreen.emit();return}this.terminalDialogService.openFullScreenDialog(this.isFullscreen)}},g.\u0275fac=function(r){return new(r||g)(f(I),f(E),f(Xe))},g.\u0275cmp=b({type:g,selectors:[["ms-terminal-toolbar"]],inputs:{isFullscreen:"isFullscreen",isScriptActive:"isScriptActive"},outputs:{clearTerminal:"clearTerminal",scrollToTopTerminal:"scrollToTopTerminal",scrollToBottomTerminal:"scrollToBottomTerminal",searchTerminal:"searchTerminal",disposeSearch:"disposeSearch",exitFullscreen:"exitFullscreen"},standalone:!0,features:[S],decls:21,vars:6,consts:[["tooltipPanel","msTooltipPanel"],["searchTooltipContent",""],[1,"buttons-wrapper"],["mat-icon-button","","color","primary","matTooltip","Search terminal","position","top",3,"closed","msTooltipPanel","closeOnBackdropClick","showCloseButton"],["fontSet","ms","fontIcon","icon-MagnifyingGlass"],["mat-icon-button","","color","primary","matTooltip","Terminal history",3,"click"],["mat-icon-button","","color","primary","matTooltip","Scroll to top",3,"click"],["fontSet","ms","fontIcon","icon-ArrowUp"],["mat-icon-button","","color","primary","matTooltip","Scroll to bottom",3,"click"],["fontSet","ms","fontIcon","icon-ArrowDown"],["mat-icon-button","","color","primary","matTooltip","Clear terminal",3,"click","disabled"],["mat-icon-button","","color","primary","matTooltip","Toggle fullscreen",3,"click"],["mat-icon-button","","color","warn","matTooltip","Stop current process",3,"click","disabled"],["fontSet","ms","fontIcon","icon-X",1,"mat-error"],[1,"form-field-container","dark"],["subscriptSizing","dynamic"],["msErrorDisplay","","matInput","",3,"formControl"],["fontSet","ms","fontIcon","icon-MagnifyingGlass","matSuffix",""]],template:function(r,t){if(r&1){let o=F();n(0,"div",2)(1,"button",3,0),a("closed",function(){return p(o),t.disposeSearch.emit(),d(t.searchFormControl.setValue(""))}),m(3,"mat-icon",4),l(),n(4,"button",5),a("click",function(){p(o);let v=z(2);return t.openTerminalMessagesHistoryDialog(),d(v.closePanel())}),n(5,"mat-icon"),y(6,"history"),l()(),n(7,"button",6),a("click",function(){return p(o),d(t.scrollToTopTerminal.emit())}),m(8,"mat-icon",7),l(),n(9,"button",8),a("click",function(){return p(o),d(t.scrollToBottomTerminal.emit())}),m(10,"mat-icon",9),l(),n(11,"button",10),a("click",function(){return p(o),d(t.clearTerminalScreen())}),n(12,"mat-icon"),y(13," clear_all"),l()(),n(14,"button",11),a("click",function(){return p(o),d(t.openFullScreenMode())}),n(15,"mat-icon"),y(16),l()(),n(17,"button",12),a("click",function(){return p(o),d(t.ctaStopScript())}),m(18,"mat-icon",13),l()(),C(19,et,6,1,"ng-template",null,1,le)}if(r&2){let o=z(20);u(),h("msTooltipPanel",o)("closeOnBackdropClick",!1)("showCloseButton",!0),u(10),h("disabled",t.isScriptActive),u(5),re(t.isFullscreen?"fullscreen_exit":"fullscreen"),u(),h("disabled",!t.isScriptActive)}},dependencies:[k,D,x,B,O,ke,Fe,He,ve,de,ue,Te,he,Ce,Se,ge,be,ye,we]}),g);je=_([P({})],je);export{Ie as a,je as b};
