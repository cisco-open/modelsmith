import{a as te}from"./chunk-UHYTAY7O.js";import{a as se,b as le,c as me}from"./chunk-VLO6NL53.js";import{a as J,b as $}from"./chunk-GWFXRHCV.js";import{c as K,f as W,g as X}from"./chunk-XX6ZYDLH.js";import{a as Y,c as Z}from"./chunk-QXM4YYRP.js";import{n as ee}from"./chunk-3IJULEGV.js";import{a as I,b as T}from"./chunk-QJ55TOIV.js";import"./chunk-CYUWMGXJ.js";import{a as N,d as Q,h as P,j as q,k as G}from"./chunk-HULQWYRR.js";import{$a as o,Ab as x,D as y,Da as c,Ea as g,J as C,Pa as w,Ra as p,Tb as H,Xd as E,Zb as A,ab as n,ae as k,bb as s,e as u,ee as B,fb as v,ga as M,he as O,ib as d,kb as S,oa as l,oe as V,p as F,pa as m,pb as _,pe as z,qb as b,rb as D,se as R,tb as f,te as j,ve as L,we as U}from"./chunk-DL2LTWBU.js";var re=u(se()),oe=u(le()),ne=u(me());var ce=["terminalHistory"];function pe(h,e){if(h&1){let t=v();o(0,"mat-icon",16),d("click",function(){l(t);let a=S();return m(a.disposeSearch())}),f(1,"close"),n()}}function de(h,e){h&1&&(o(0,"mat-icon",17),f(1,"search"),n())}var r,ie=(r=class{constructor(e,t){this.dialogConfig=e,this.terminalFacadeService=t,this.searchFormControl=new B(""),this.terminal=new ne.Terminal({theme:{background:"#D0D4D9",foreground:"#000000",cursor:"#000000"},cursorBlink:!1,disableStdin:!0,allowProposedApi:!0}),this.fitAddon=new re.FitAddon,this.searchAddon=new oe.SearchAddon}ngOnInit(){this.initializeTerminal(),this.loadData(),this.listenToSearchFormControlChanges(),W()}ngAfterViewInit(){this.adjustHeightToParent(),this.fitTerminalToContainer()}loadData(){this.terminalFacadeService.dispatch(te.getTerminalHistory()),this.terminalFacadeService.terminalHistory.pipe(T(this)).subscribe(e=>{e&&this.writeToTerminal(e)})}initializeTerminal(){this.terminal.loadAddon(this.fitAddon),this.terminal.loadAddon(this.searchAddon),this.terminal.open(this.terminalHistoryDiv.nativeElement),this.setupResizeObserver()}listenToSearchFormControlChanges(){this.searchFormControl.valueChanges.pipe(T(this),C(300),y(e=>!K(e))).subscribe(e=>{this.search(e)})}search(e){this.searchAddon.findNext(e,{decorations:{matchBackground:"#FFFF00",matchBorder:"#FFFF00",matchOverviewRuler:"#FFFF00",activeMatchBackground:"#FFFF00",activeMatchBorder:"#FFFF00",activeMatchColorOverviewRuler:"#FFFF00"}})}disposeSearch(){this.searchAddon.clearDecorations(),this.searchFormControl.setValue("")}writeToTerminal(e){let t=this.filterClearCommand(e);this.terminal.write(t)}filterClearCommand(e){let t=/\x1B\[H\x1B\[J/g;return e.replace(t,"")}setupResizeObserver(){this.resizeObserver&&this.resizeObserver.disconnect(),this.resizeObserver=new ResizeObserver(()=>this.fitTerminalToContainer()),this.resizeObserver.observe(this.terminalHistoryDiv.nativeElement)}fitTerminalToContainer(){this.fitAddon.fit()}adjustHeightToParent(){let e=this.terminalHistoryDiv.nativeElement.parentElement.parentElement.parentElement.parentElement;if(e){let t;t=e.offsetHeight-280,this.terminalHistoryDiv.nativeElement.style.height=`${t}px`}}scrollToTopTerminal(){this.terminal.scrollToTop()}scrollToBottomTerminal(){this.terminal.scrollToBottom()}ngOnDestroy(){this.resizeObserver?.disconnect(),X()}},r.\u0275fac=function(t){return new(t||r)(g(Y),g(ee))},r.\u0275cmp=M({type:r,selectors:[["ms-terminal-messages-history-dialog"]],viewQuery:function(t,i){if(t&1&&_(ce,7),t&2){let a;b(a=D())&&(i.terminalHistoryDiv=a.first)}},standalone:!0,features:[x],decls:19,vars:3,consts:[["terminalHistory",""],[1,"ms-terminal-wrapper"],[1,"top-terminal-section"],[1,"left"],[1,"form-field-container"],["subscriptSizing","dynamic"],["matInput","","placeholder","Search terminal messages",3,"formControl"],["matSuffix","","class","mat-error scale-on-hover",3,"click",4,"ngIf"],["matSuffix","","class","mat-primary",4,"ngIf"],[1,"right"],["mat-icon-button","","color","primary","matTooltip","Scroll to top",3,"click"],["fontSet","ms","fontIcon","icon-ArrowUp"],["mat-icon-button","","color","primary","matTooltip","Scroll to bottom",3,"click"],["fontSet","ms","fontIcon","icon-ArrowDown"],[1,"terminal"],[1,"terminal-wrapper"],["matSuffix","",1,"mat-error","scale-on-hover",3,"click"],["matSuffix","",1,"mat-primary"]],template:function(t,i){if(t&1){let a=v();o(0,"ms-dialog")(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"mat-label"),f(6,"Search"),n(),o(7,"mat-form-field",5),s(8,"input",6),w(9,pe,2,0,"mat-icon",7)(10,de,2,0,"mat-icon",8),n()()(),o(11,"div",9)(12,"button",10),d("click",function(){return l(a),m(i.scrollToTopTerminal())}),s(13,"mat-icon",11),n(),o(14,"button",12),d("click",function(){return l(a),m(i.scrollToBottomTerminal())}),s(15,"mat-icon",13),n()()(),o(16,"div",14),s(17,"div",15,0),n()()()}t&2&&(c(8),p("formControl",i.searchFormControl),c(),p("ngIf",i.searchFormControl.value),c(),p("ngIf",!i.searchFormControl.value))},dependencies:[A,H,Z,U,L,j,R,V,E,k,z,O,G,q,P,N,Q,$,J],styles:[`.ms-terminal-wrapper{overflow-x:auto}.ms-terminal-wrapper .terminal-wrapper{border:10px solid var(--terminal-color);background-color:var(--terminal-color);border-radius:10px}.ms-terminal-wrapper .xterm-viewport{overflow-y:auto!important}.ms-terminal-wrapper .top-terminal-section{display:flex;justify-content:space-between;margin-bottom:10px}.ms-terminal-wrapper .top-terminal-section .right{display:flex;align-items:flex-end}
`],encapsulation:2}),r);ie=F([I()],ie);export{ie as MsTerminalMessagesHistoryDialogComponent};
