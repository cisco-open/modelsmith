import{a as P}from"./chunk-6QZ263AU.js";import{a as b}from"./chunk-M6XLY3MM.js";import"./chunk-LWFFWU3Z.js";import"./chunk-NQ3K4VXT.js";import"./chunk-GZ3MP4I3.js";import"./chunk-EWCYLHFH.js";import"./chunk-AQXO3PTH.js";import"./chunk-KW4JYWBM.js";import{a as Nt,b as Ot}from"./chunk-TAQAVLZV.js";import"./chunk-36MMDLJ6.js";import"./chunk-OC2XOUQE.js";import{a as I,b as bt,c as _t,d as V}from"./chunk-AGTOMP23.js";import{a as Mt,b as Ft}from"./chunk-OCTHNKRP.js";import"./chunk-UWVTK5BS.js";import"./chunk-7BE636IS.js";import"./chunk-LS3MZLOQ.js";import{b as S,c as d,g as Tt,l as At}from"./chunk-OSQ72SWC.js";import"./chunk-ZTF7MLCF.js";import"./chunk-YRSJWEPX.js";import"./chunk-TGB2NBUR.js";import{b as K,c as Ct}from"./chunk-XX6ZYDLH.js";import"./chunk-UWH6VIL2.js";import{a as N,b as O,c as It,j as Pt}from"./chunk-GGGBW6XD.js";import"./chunk-DUIITRQ3.js";import{h as vt,i as yt}from"./chunk-3DEWYFT2.js";import{$a as X,$c as nt,Aa as p,B as v,Ec as u,F as H,G as $,I as q,N as B,Na as s,Pd as at,Qd as mt,Va as L,Wa as w,X as y,Xa as a,Xb as rt,Ya as l,Za as j,Zd as st,_ as Z,_a as W,_d as g,a as _,ae as lt,b as R,bb as J,be as M,ca as C,ce as F,da as T,eb as k,ee as pt,jc as ot,je as ct,ka as G,ke as dt,la as E,lb as Y,mb as tt,me as ht,nb as et,nc as U,pb as c,pe as ft,qe as ut,rb as D,re as gt,sa as A,ue as St,v as x,wb as it,za as n}from"./chunk-ED6LLMLR.js";var Rt=(r,t)=>t.key;function Dt(r,t){if(r&1&&(a(0,"mat-option",6),c(1),l()),r&2){let h=t.$implicit;s("value",h.key),n(),D(" ",h.value," ")}}function Ut(r,t){if(r&1&&(a(0,"mat-option",6),c(1),l()),r&2){let h=t.$implicit;s("value",h.key),n(),D(" ",h.value," ")}}var Gt=(()=>{let t=class t{get parentFormGroup(){return this.controlContainer.control}get algorithmFormGroup(){return this.parentFormGroup.get(this.controlKey)}get algorithmFormControl(){return this.algorithmFormGroup?.get(this.ALGORITHM_CONTROL_NAME)}constructor(e,i,o){this.destroyRef=e,this.controlContainer=i,this.scriptFacadeService=o,this.controlKey="",this.pruningAlgorithmsList=bt,this.quantAlgorithmsList=_t,this.ALGORITHM_CONTROL_NAME="alg"}ngOnInit(){this.initForm(),this.listenToScriptStateChanges(),this.loadInitialData()}loadInitialData(){this.scriptFacadeService.scriptDetails$.pipe(B(1),$(1),v(e=>!Ct(e?.algKey))).subscribe(e=>{let i=e.type,m=i===d.PRUNING||i===d.QUANTIZATION?e.algKey:V;this.algorithmFormControl?.setValue(m)}),this.scriptFacadeService.dispatch(N.getCurrentOrLastActiveScriptDetails())}initForm(){this.parentFormGroup.addControl(this.controlKey,new F({[this.ALGORITHM_CONTROL_NAME]:new pt(V,st.required)}))}listenToScriptStateChanges(){this.scriptFacadeService.scriptStatus$.pipe(u(this.destroyRef)).subscribe(e=>{S(e)?this.algorithmFormGroup.disable():this.algorithmFormGroup.enable()})}ngOnDestroy(){this.parentFormGroup.removeControl(this.controlKey)}};t.\u0275fac=function(i){return new(i||t)(p(A),p(g),p(O))},t.\u0275cmp=C({type:t,selectors:[["ms-panel-algorithm"]],inputs:{controlKey:"controlKey"},features:[it([],[{provide:g,useFactory:()=>Z(g,{skipSelf:!0})}])],decls:12,vars:2,consts:[[1,"ms-card","algorithm-card"],[1,"heading-sub-section-title"],[1,"form-field-container",3,"formGroupName"],["appearance","outline","subscriptSizing","dynamic"],[3,"formControlName"],["label","Pruning"],[3,"value"],["label","Quantization"]],template:function(i,o){i&1&&(a(0,"mat-card",0)(1,"p",1),c(2,"Algorithm"),l(),a(3,"div",2)(4,"mat-form-field",3)(5,"mat-select",4)(6,"mat-optgroup",5),L(7,Dt,2,2,"mat-option",6,Rt),l(),a(9,"mat-optgroup",7),L(10,Ut,2,2,"mat-option",6,Rt),l()()()()()),i&2&&(n(3),s("formGroupName",o.controlKey),n(2),s("formControlName",o.ALGORITHM_CONTROL_NAME),n(2),w(o.pruningAlgorithmsList),n(3),w(o.quantAlgorithmsList))},dependencies:[Mt,vt,Nt,mt,at,lt,M,ht,dt]});let r=t;return r})();var z="custommodel";function Et(r){let t=r.replace(/[^a-zA-Z0-9_]/g,"_");return/^[0-9_]/.test(t)&&(t="file_"+t),/.py$/.test(t)||(t+=".py"),t}var Vt=["panelParameters"],Lt=(()=>{let t=class t{constructor(e,i,o,m,f){this.destroyRef=e,this.scriptFacadeService=i,this.fileService=o,this.snackbarService=m,this.router=f,this.form=new F({}),this.AlgorithmType=d,this.isScriptActive=!1,this.isQuantAlgorithmSelected=!1,this.selectedAlgorithm=Tt.IMP,this.selectedAlgorithmType=d.PRUNING}ngOnInit(){this.listenToAlgorithmPanelChanges(),this.listenToScriptStateChanges()}listenToAlgorithmPanelChanges(){this.form.valueChanges.pipe(H(50),x(()=>{let e=this.form.getRawValue();return e.algorithm&&e.algorithm.alg}),q(),v(e=>!K(e)),u(this.destroyRef)).subscribe(e=>{this.selectedAlgorithm=e,this.selectedAlgorithmType=At(e)})}listenToScriptStateChanges(){this.scriptFacadeService.scriptStatus$.pipe(u(this.destroyRef)).subscribe(e=>{this.isScriptActive=S(e),S(e)?this.form.disable():this.form.enable()})}submit(){if(K(this.selectedAlgorithm)){this.snackbarService.showError("Select an algorithm before running a script.");return}let{algorithm:e,model:i}=this.form.getRawValue(),{model:o}=i;if(o===z&&!this.fileService.isFileLoaded){this.snackbarService.showError("Please select a predefined model or upload a custom file.");return}let m=o===z?Et(this.fileService?.file.name):o,f=R(_({},e),{params:R(_({},this.panelParametersComponent.parametersFormatted),{arch:m})});this.scriptFacadeService.dispatch(N.callScript({configs:f}))}goToChartPage(){this.router.navigate([nt.RUNNING.ROOT])}};t.\u0275fac=function(i){return new(i||t)(p(A),p(O),p(Pt),p(It),p(ot))},t.\u0275cmp=C({type:t,selectors:[["ms-machine-unlearning"]],viewQuery:function(i,o){if(i&1&&Y(Vt,5),i&2){let m;tt(m=et())&&(o.panelParametersComponent=m.first)}},decls:17,vars:5,consts:[["panelAlgorithm",""],["panelParameters",""],[1,"heading-primary-title","title"],[1,"page-wrapper",3,"formGroup"],[1,"left"],[3,"formGroup"],["controlKey","algorithm"],["controlKey","model",3,"algorithmType"],["controlKey","params",3,"algorithm"],["mat-raised-button","","color","primary",3,"click","disabled"],["mat-raised-button","","color","primary",1,"ml-2",3,"click"],[1,"right"]],template:function(i,o){if(i&1){let m=J();a(0,"p",2),c(1,"Model Compression"),l(),a(2,"div",3)(3,"div",4),W(4,5),j(5,"ms-panel-algorithm",6,0)(7,"ms-panel-model",7)(8,"ms-panel-parameters",8,1),X(),a(10,"div")(11,"button",9),k("click",function(){return G(m),E(o.submit())}),c(12," Run "),l(),a(13,"button",10),k("click",function(){return G(m),E(o.goToChartPage())}),c(14,"View Chart"),l()()(),a(15,"div",11),j(16,"ms-terminal-xterm-with-toolbar"),l()()}i&2&&(n(2),s("formGroup",o.form),n(2),s("formGroup",o.form),n(3),s("algorithmType",o.selectedAlgorithmType),n(),s("algorithm",o.selectedAlgorithm),n(3),s("disabled",o.isScriptActive||o.form.invalid))},dependencies:[I,P,b,M,ct,gt,Gt],styles:[".title[_ngcontent-%COMP%]{margin-bottom:13px}"]});let r=t;return r})();var Qt=[{path:"",component:Lt}],wt=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=T({type:t}),t.\u0275inj=y({imports:[U.forChild(Qt),U]});let r=t;return r})();var Qe=(()=>{let t=class t{};t.\u0275fac=function(i){return new(i||t)},t.\u0275mod=T({type:t}),t.\u0275inj=y({imports:[rt,wt,I,P,b,Ft,yt,Ot,ft,ut,St]});let r=t;return r})();export{Qe as ModelCompressionModule};
