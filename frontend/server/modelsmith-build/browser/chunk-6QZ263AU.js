import{b as Me,c as ge,d as F}from"./chunk-LWFFWU3Z.js";import{a as ne}from"./chunk-NQ3K4VXT.js";import{a as le,b as de}from"./chunk-GZ3MP4I3.js";import{b as oe}from"./chunk-EWCYLHFH.js";import{a as ue,b as fe}from"./chunk-TAQAVLZV.js";import{a as ce,b as pe}from"./chunk-OCTHNKRP.js";import{a as he}from"./chunk-LS3MZLOQ.js";import{b as re}from"./chunk-OSQ72SWC.js";import{c as ae,d as se}from"./chunk-XX6ZYDLH.js";import{b as me}from"./chunk-GGGBW6XD.js";import{h as Z,i as ee}from"./chunk-3DEWYFT2.js";import{$c as k,Aa as d,B as T,Cb as y,Db as v,Ec as g,La as c,Na as u,O as b,Pd as B,Qd as $,Ta as p,Ub as K,Va as I,Wa as L,Xa as l,Xb as A,Ya as s,Za as M,Zd as z,_ as O,_d as h,ae as q,be as U,ca as R,ce as W,ee as _,gb as E,ie as X,ja as N,kc as j,ke as H,me as J,pb as f,pe as Q,qe as Y,rb as x,sa as P,v as S,vb as G,wb as V,we as te,xb as D,xe as ie,za as a,zb as w}from"./chunk-ED6LLMLR.js";var Ce=(t,i)=>i.name,Se=t=>[t];function ye(t,i){t&1&&M(0,"ms-spining-indicator",10)}function ve(t,i){if(t&1&&(l(0,"div",3)(1,"a",9),f(2,"Train models"),s(),G(3),y(4,"async"),c(5,ye,1,0,"ms-spining-indicator",10),s()),t&2){let r=E();a(),u("routerLink",w(4,Se,"/"+r.RoutesList.MODEL_TRAINING.ROOT));let e=v(4,2,r.pageRunningScriptSpiningIndicatorService.currentRunningPageInfo$);a(4),p((e==null?null:e.page)===r.PageKey.MODEL_TRAINING?5:-1)}}function _e(t,i){t&1&&M(0,"mat-icon",13)}function Fe(t,i){if(t&1&&(l(0,"mat-option",11),f(1),c(2,_e,1,0,"mat-icon",13),s()),t&2){let r=i.$implicit;u("value",r.name)("disabled",!r.isTrained),a(),x(" ",r.name," "),a(),p(r.isTrained?-1:2)}}function Te(t,i){t&1&&(l(0,"mat-option",12),f(1,"No results found"),s())}function be(t,i){if(t&1&&(I(0,Fe,3,4,"mat-option",11,Ce),c(2,Te,2,0,"mat-option",12)),t&2){let r=i;L(r),a(2),p(r.length===0?2:-1)}}var nt=(()=>{let i=class i{ngOnChanges(e){e.algorithmType&&e.algorithmType.currentValue&&this.configureModels(e.algorithmType.currentValue)}get parentFormGroup(){return this.controlContainer.control}get modelFormGroup(){return this.parentFormGroup.get(this.controlKey)}get modelControl(){return this.modelFormGroup?.get(this.MODEL_CONTROL_NAME)}constructor(e,n,o,m,C){this.destroyRef=e,this.controlContainer=n,this.modelsFacadeService=o,this.scriptFacadeService=m,this.pageRunningScriptSpiningIndicatorService=C,this.controlKey="",this.isTrainModelsPageRouteVisible=!0,this.PageKey=le,this.RoutesList=k,this.searchModel=new _,this.models=[],this.MODEL_CONTROL_NAME="model"}ngOnInit(){this.initializeForm(),this.listenToScriptStateChanges(),this.listenToSearchModelValueChanges(),this.configureModels(this.algorithmType)}configureModels(e){e&&(this.getModelsByTypeSubscription?.unsubscribe(),this.getModelsByTypeSubscription=this.subscribeToModelsListChanges(e),this.modelsFacadeService.dispatch(F.getModelsList({algorithmType:e})),this.modelsFacadeService.dispatch(F.getCurrentOrPreviousSelectedModel({algorithmType:e})))}listenToCurrentModelChanges(){this.modelsFacadeService.currentModel$.pipe(g(this.destroyRef)).subscribe(e=>{if(ae(e))return;let n=this.models.find(o=>o.name===e);n&&n.isTrained&&this.modelControl?.patchValue(e)})}subscribeToModelsListChanges(e){let n=!1;return this.modelsFacadeService.getModelsByType(e).pipe(T(o=>!se(o)),S(o=>[...o].sort((m,C)=>Number(C.isTrained)-Number(m.isTrained)))).subscribe(o=>{this.models=o,this.searchModel.setValue(""),n||(this.listenToCurrentModelChanges(),n=!0)})}initializeForm(){this.parentFormGroup.addControl(this.controlKey,new W({[this.MODEL_CONTROL_NAME]:new _("",z.required)}))}listenToScriptStateChanges(){this.scriptFacadeService.scriptStatus$.pipe(g(this.destroyRef)).subscribe(e=>{re(e)?this.modelFormGroup.disable():this.modelFormGroup.enable()})}listenToSearchModelValueChanges(){this.filteredModels=this.searchModel.valueChanges.pipe(g(this.destroyRef),b(""),S(e=>this.filterModels(e)))}filterModels(e){let n=e.toLowerCase();return this.models.filter(o=>o.name.toLowerCase().includes(n))}ngOnDestroy(){this.parentFormGroup.removeControl(this.controlKey)}};i.\u0275fac=function(n){return new(n||i)(d(P),d(h),d(he),d(me),d(de))},i.\u0275cmp=R({type:i,selectors:[["ms-panel-model"]],inputs:{controlKey:"controlKey",algorithmType:"algorithmType",isTrainModelsPageRouteVisible:"isTrainModelsPageRouteVisible"},standalone:!0,features:[V([],[{provide:h,useFactory:()=>O(h,{skipSelf:!0})}]),N,D],decls:13,vars:6,consts:[[1,"ms-card","model-card"],[1,"panel-title-wrapper"],[1,"heading-sub-section-title"],[1,"train-models"],[1,"form-field-container",3,"formGroupName"],["appearance","outline","subscriptSizing","dynamic"],["formControlName","model","placeholder","Select a model..."],[3,"formControl"],["label","Predefined Models"],[3,"routerLink"],[1,"ml-2"],[3,"value","disabled"],["disabled",""],["fontSet","ms","fontIcon","icon-X",1,"mat-error"]],template:function(n,o){if(n&1&&(l(0,"mat-card",0)(1,"div",1)(2,"div",2),f(3,"Model"),s(),c(4,ve,6,6,"div",3),s(),l(5,"div",4)(6,"mat-form-field",5)(7,"mat-select",6)(8,"mat-option"),M(9,"ngx-mat-select-search",7),s(),l(10,"mat-optgroup",8),c(11,be,3,1),y(12,"async"),s()()()()()),n&2){let m;a(4),p(o.isTrainModelsPageRouteVisible?4:-1),a(),u("formGroupName",o.controlKey),a(4),u("formControl",o.searchModel),a(2),p((m=v(12,4,o.filteredModels))?11:-1,m)}},dependencies:[A,K,Q,q,U,Y,X,J,H,pe,ce,ee,Z,fe,ue,$,B,ie,te,ge,Me,j,oe,ne],styles:[".panel-title-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:12px}.panel-title-wrapper[_ngcontent-%COMP%]   .train-models[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}"]});let t=i;return t})();export{nt as a};
