import{a as N}from"./chunk-QWPZ5EFE.js";import{a as I}from"./chunk-R5J4FM6S.js";import"./chunk-DQ7AOZDA.js";import"./chunk-3S6QBQVM.js";import"./chunk-D2Y5ESR4.js";import"./chunk-TO7IPVMR.js";import{a as Nt,b as It}from"./chunk-G267DK6J.js";import"./chunk-GSC3HYC7.js";import"./chunk-VUPIOU6P.js";import"./chunk-PP7DOJYP.js";import{a as _,b as Et,c as Rt,d as B}from"./chunk-QVZ2CSJP.js";import"./chunk-WHP5P3DQ.js";import"./chunk-SMKHMGDE.js";import{b as g,d as Q,e as Tt,g as f,k as Mt,p as Ot}from"./chunk-W4U3FJPJ.js";import{a as Pt,b as _t}from"./chunk-2FJ2YO2M.js";import{a as O,b as P,d as bt,k as Gt}from"./chunk-PSFPSLKI.js";import{a as F,b as d}from"./chunk-GMIVG7ET.js";import"./chunk-NT2MTW7W.js";import{h as At,i as Ft}from"./chunk-HG2O7P4S.js";import{$ as v,Ab as ot,E as y,Ea as n,Fa as c,I as q,J as x,L as Z,Q as J,Qa as j,Sa as a,Tb as nt,Td as lt,Ud as pt,a as R,ab as m,b as L,bb as s,bc as at,be as ct,cb as D,ce as u,da as W,db as X,dd as st,eb as Y,ee as ht,fe as T,gb as tt,ge as M,ha as C,ia as A,ie as ft,jb as K,me as dt,ne as ut,oc as mt,p as S,pa as w,pe as gt,qa as k,qb as et,rb as it,sb as rt,sc as V,se as St,te as yt,ub as h,ue as vt,wb as U,x as $,xe as Ct}from"./chunk-NPZHNGVX.js";function Dt(r,t){if(r&1&&(m(0,"mat-option",8),h(1),s()),r&2){let e=t.$implicit;a("value",e.key),n(),U(" ",e.value," ")}}function Kt(r,t){if(r&1&&(m(0,"mat-option",8),h(1),s()),r&2){let e=t.$implicit;a("value",e.key),n(),U(" ",e.value," ")}}var l,b=(l=class{get parentFormGroup(){return this.controlContainer.control}get algorithmFormGroup(){return this.parentFormGroup.get(this.controlKey)}get algorithmFormControl(){return this.algorithmFormGroup?.get(this.ALGORITHM_CONTROL_NAME)}constructor(t,e){this.controlContainer=t,this.scriptFacadeService=e,this.controlKey="",this.pruningAlgorithmsList=Et,this.quantAlgorithmsList=Rt,this.ALGORITHM_CONTROL_NAME="alg"}ngOnInit(){this.initForm(),this.listenToScriptStateChanges(),this.loadInitialData()}loadInitialData(){this.scriptFacadeService.scriptDetails$.pipe(J(1),x(1),y(t=>!Tt(t?.algKey))).subscribe(t=>{let e=t.type,o=e===f.PRUNING||e===f.QUANTIZATION?t.algKey:B;this.algorithmFormControl?.setValue(o)}),this.scriptFacadeService.dispatch(O.getCurrentOrLastActiveScriptDetails())}initForm(){this.parentFormGroup.addControl(this.controlKey,new M({[this.ALGORITHM_CONTROL_NAME]:new ft(B,ct.required)}))}listenToScriptStateChanges(){this.scriptFacadeService.scriptStatus$.pipe(d(this)).subscribe(t=>{g(t)?this.algorithmFormGroup.disable():this.algorithmFormGroup.enable()})}trackByAlgorithmKey(t,e){return e.key}ngOnDestroy(){this.parentFormGroup.removeControl(this.controlKey)}},l.\u0275fac=function(e){return new(e||l)(c(u),c(P))},l.\u0275cmp=C({type:l,selectors:[["ms-panel-algorithm"]],inputs:{controlKey:"controlKey"},features:[ot([],[{provide:u,useFactory:()=>W(u,{skipSelf:!0})}])],decls:10,vars:6,consts:[[1,"ms-card","algorithm-card"],[1,"heading-sub-section-title"],[1,"form-field-container",3,"formGroupName"],["appearance","outline","subscriptSizing","dynamic"],[3,"formControlName"],["label","Pruning"],[3,"value",4,"ngFor","ngForOf","ngForTrackBy"],["label","Quantization"],[3,"value"]],template:function(e,i){e&1&&(m(0,"mat-card",0)(1,"p",1),h(2,"Algorithm"),s(),m(3,"div",2)(4,"mat-form-field",3)(5,"mat-select",4)(6,"mat-optgroup",5),j(7,Dt,2,2,"mat-option",6),s(),m(8,"mat-optgroup",7),j(9,Kt,2,2,"mat-option",6),s()()()()()),e&2&&(n(3),a("formGroupName",i.controlKey),n(2),a("formControlName",i.ALGORITHM_CONTROL_NAME),n(2),a("ngForOf",i.pruningAlgorithmsList)("ngForTrackBy",i.trackByAlgorithmKey),n(2),a("ngForOf",i.quantAlgorithmsList)("ngForTrackBy",i.trackByAlgorithmKey))},dependencies:[nt,Pt,At,Nt,pt,lt,ht,T,gt,ut]}),l);b=S([F()],b);var H="custommodel";function Lt(r){let t=r.replace(/[^a-zA-Z0-9_]/g,"_");return/^[0-9_]/.test(t)&&(t="file_"+t),/.py$/.test(t)||(t+=".py"),t}var Vt=["panelParameters"],p,G=(p=class{constructor(t,e,i,o){this.scriptFacadeService=t,this.fileService=e,this.snackbarService=i,this.router=o,this.form=new M({}),this.AlgorithmType=f,this.isScriptActive=!1,this.isQuantAlgorithmSelected=!1,this.selectedAlgorithm=Mt.IMP,this.selectedAlgorithmType=f.PRUNING}ngOnInit(){this.listenToAlgorithmPanelChanges(),this.listenToScriptStateChanges()}listenToAlgorithmPanelChanges(){this.form.valueChanges.pipe(q(50),$(()=>{let t=this.form.getRawValue();return t.algorithm&&t.algorithm.alg}),Z(),y(t=>!Q(t)),d(this)).subscribe(t=>{this.selectedAlgorithm=t,this.selectedAlgorithmType=Ot(t)})}listenToScriptStateChanges(){this.scriptFacadeService.scriptStatus$.pipe(d(this)).subscribe(t=>{this.isScriptActive=g(t),g(t)?this.form.disable():this.form.enable()})}submit(){if(Q(this.selectedAlgorithm)){this.snackbarService.showError("Select an algorithm before running a script.");return}let{algorithm:t,model:e}=this.form.getRawValue(),{model:i}=e;if(i===H&&!this.fileService.isFileLoaded){this.snackbarService.showError("Please select a predefined model or upload a custom file.");return}let o=i===H?Lt(this.fileService?.file.name):i,E=L(R({},t),{params:L(R({},this.panelParametersComponent.parametersFormatted),{arch:o})});this.scriptFacadeService.dispatch(O.callScript({configs:E}))}goToChartPage(){this.router.navigate([st.RUNNING.ROOT])}},p.\u0275fac=function(e){return new(e||p)(c(P),c(Gt),c(bt),c(mt))},p.\u0275cmp=C({type:p,selectors:[["ms-machine-unlearning"]],viewQuery:function(e,i){if(e&1&&et(Vt,5),e&2){let o;it(o=rt())&&(i.panelParametersComponent=o.first)}},decls:17,vars:5,consts:[["panelAlgorithm",""],["panelParameters",""],[1,"heading-primary-title","title"],[1,"page-wrapper",3,"formGroup"],[1,"left"],[3,"formGroup"],["controlKey","algorithm"],["controlKey","model",3,"algorithmType"],["controlKey","params",3,"algorithm"],["mat-raised-button","","color","primary",3,"click","disabled"],["mat-raised-button","","color","primary",1,"ml-2",3,"click"],[1,"right"]],template:function(e,i){if(e&1){let o=tt();m(0,"p",2),h(1,"Model Compression"),s(),m(2,"div",3)(3,"div",4),X(4,5),D(5,"ms-panel-algorithm",6,0)(7,"ms-panel-model",7)(8,"ms-panel-parameters",8,1),Y(),m(10,"div")(11,"button",9),K("click",function(){return w(o),k(i.submit())}),h(12," Run "),s(),m(13,"button",10),K("click",function(){return w(o),k(i.goToChartPage())}),h(14,"View Chart"),s()()(),m(15,"div",11),D(16,"ms-terminal"),s()()}e&2&&(n(2),a("formGroup",i.form),n(2),a("formGroup",i.form),n(3),a("algorithmType",i.selectedAlgorithmType),n(),a("algorithm",i.selectedAlgorithm),n(3),a("disabled",i.isScriptActive||i.form.invalid))},dependencies:[_,N,I,T,dt,vt,b],styles:[".title[_ngcontent-%COMP%]{margin-bottom:13px}"]}),p);G=S([F()],G);var Qt=[{path:"",component:G}],wt=(()=>{let t=class t{};t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=A({type:t}),t.\u0275inj=v({imports:[V.forChild(Qt),V]});let r=t;return r})();var He=(()=>{let t=class t{};t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=A({type:t}),t.\u0275inj=v({imports:[at,wt,_,N,I,_t,Ft,It,St,yt,Ct]});let r=t;return r})();export{He as ModelCompressionModule};
