import{a as O}from"./chunk-WQUNOANI.js";import{a as b}from"./chunk-BZXD44PM.js";import"./chunk-5ZLPWT2K.js";import"./chunk-2YCNMDJU.js";import"./chunk-6OG4GIDG.js";import"./chunk-NIBPW2FQ.js";import"./chunk-74GRTMWA.js";import{a as Ot,b as bt}from"./chunk-KECYA32T.js";import"./chunk-RT4UIWZY.js";import"./chunk-M23HJHX6.js";import{a as _,b as Et,c as Rt,d as x}from"./chunk-P7CYYRPF.js";import{a as Nt,b as _t}from"./chunk-CFYL7YUG.js";import"./chunk-VNGDSIUJ.js";import"./chunk-UVRKHTIO.js";import{b as g,c as d,g as Ft,l as Pt}from"./chunk-C4NPICWQ.js";import"./chunk-7E7D3R2F.js";import"./chunk-YRSCX2CX.js";import"./chunk-BSTDKCK6.js";import"./chunk-AH3UZEPK.js";import{b as z,c as Mt}from"./chunk-XX6ZYDLH.js";import"./chunk-KN3ES7HG.js";import{a as P,b as N,c as It,j as Gt}from"./chunk-REE2RBO3.js";import{a as T,b as f}from"./chunk-V63QBU7B.js";import"./chunk-OFI24AXH.js";import{h as At,i as Tt}from"./chunk-GZP2I6OY.js";import{$a as k,$b as at,Bb as nt,D as C,Ea as n,Fa as c,H as B,I as Z,K as W,P as X,Sa as m,Td as lt,Ud as pt,_ as v,_a as D,a as R,ab as a,b as L,bb as s,be as ct,ca as J,cb as U,ce as u,db as Y,dd as st,eb as tt,ee as ht,fe as M,ga as y,gb as et,ge as F,ha as A,ie as dt,jb as K,nc as mt,ne as ft,oa as w,oe as ut,p as S,pa as j,qb as it,qe as gt,rb as rt,rc as Q,sb as ot,te as St,ub as h,ue as Ct,ve as vt,w as q,wb as V,ye as yt}from"./chunk-2CPYVQID.js";var Lt=(r,t)=>t.key;function Ut(r,t){if(r&1&&(a(0,"mat-option",6),h(1),s()),r&2){let e=t.$implicit;m("value",e.key),n(),V(" ",e.value," ")}}function Kt(r,t){if(r&1&&(a(0,"mat-option",6),h(1),s()),r&2){let e=t.$implicit;m("value",e.key),n(),V(" ",e.value," ")}}var l,I=(l=class{get parentFormGroup(){return this.controlContainer.control}get algorithmFormGroup(){return this.parentFormGroup.get(this.controlKey)}get algorithmFormControl(){return this.algorithmFormGroup?.get(this.ALGORITHM_CONTROL_NAME)}constructor(t,e){this.controlContainer=t,this.scriptFacadeService=e,this.controlKey="",this.pruningAlgorithmsList=Et,this.quantAlgorithmsList=Rt,this.ALGORITHM_CONTROL_NAME="alg"}ngOnInit(){this.initForm(),this.listenToScriptStateChanges(),this.loadInitialData()}loadInitialData(){this.scriptFacadeService.scriptDetails$.pipe(X(1),Z(1),C(t=>!Mt(t?.algKey))).subscribe(t=>{let e=t.type,o=e===d.PRUNING||e===d.QUANTIZATION?t.algKey:x;this.algorithmFormControl?.setValue(o)}),this.scriptFacadeService.dispatch(P.getCurrentOrLastActiveScriptDetails())}initForm(){this.parentFormGroup.addControl(this.controlKey,new F({[this.ALGORITHM_CONTROL_NAME]:new dt(x,ct.required)}))}listenToScriptStateChanges(){this.scriptFacadeService.scriptStatus$.pipe(f(this)).subscribe(t=>{g(t)?this.algorithmFormGroup.disable():this.algorithmFormGroup.enable()})}ngOnDestroy(){this.parentFormGroup.removeControl(this.controlKey)}},l.\u0275fac=function(e){return new(e||l)(c(u),c(N))},l.\u0275cmp=y({type:l,selectors:[["ms-panel-algorithm"]],inputs:{controlKey:"controlKey"},features:[nt([],[{provide:u,useFactory:()=>J(u,{skipSelf:!0})}])],decls:12,vars:2,consts:[[1,"ms-card","algorithm-card"],[1,"heading-sub-section-title"],[1,"form-field-container",3,"formGroupName"],["appearance","outline","subscriptSizing","dynamic"],[3,"formControlName"],["label","Pruning"],[3,"value"],["label","Quantization"]],template:function(e,i){e&1&&(a(0,"mat-card",0)(1,"p",1),h(2,"Algorithm"),s(),a(3,"div",2)(4,"mat-form-field",3)(5,"mat-select",4)(6,"mat-optgroup",5),D(7,Ut,2,2,"mat-option",6,Lt),s(),a(9,"mat-optgroup",7),D(10,Kt,2,2,"mat-option",6,Lt),s()()()()()),e&2&&(n(3),m("formGroupName",i.controlKey),n(2),m("formControlName",i.ALGORITHM_CONTROL_NAME),n(2),k(i.pruningAlgorithmsList),n(3),k(i.quantAlgorithmsList))},dependencies:[Nt,At,Ot,pt,lt,ht,M,gt,ut]}),l);I=S([T()],I);var $="custommodel";function wt(r){let t=r.replace(/[^a-zA-Z0-9_]/g,"_");return/^[0-9_]/.test(t)&&(t="file_"+t),/.py$/.test(t)||(t+=".py"),t}var Qt=["panelParameters"],p,G=(p=class{constructor(t,e,i,o){this.scriptFacadeService=t,this.fileService=e,this.snackbarService=i,this.router=o,this.form=new F({}),this.AlgorithmType=d,this.isScriptActive=!1,this.isQuantAlgorithmSelected=!1,this.selectedAlgorithm=Ft.IMP,this.selectedAlgorithmType=d.PRUNING}ngOnInit(){this.listenToAlgorithmPanelChanges(),this.listenToScriptStateChanges()}listenToAlgorithmPanelChanges(){this.form.valueChanges.pipe(B(50),q(()=>{let t=this.form.getRawValue();return t.algorithm&&t.algorithm.alg}),W(),C(t=>!z(t)),f(this)).subscribe(t=>{this.selectedAlgorithm=t,this.selectedAlgorithmType=Pt(t)})}listenToScriptStateChanges(){this.scriptFacadeService.scriptStatus$.pipe(f(this)).subscribe(t=>{this.isScriptActive=g(t),g(t)?this.form.disable():this.form.enable()})}submit(){if(z(this.selectedAlgorithm)){this.snackbarService.showError("Select an algorithm before running a script.");return}let{algorithm:t,model:e}=this.form.getRawValue(),{model:i}=e;if(i===$&&!this.fileService.isFileLoaded){this.snackbarService.showError("Please select a predefined model or upload a custom file.");return}let o=i===$?wt(this.fileService?.file.name):i,E=L(R({},t),{params:L(R({},this.panelParametersComponent.parametersFormatted),{arch:o})});this.scriptFacadeService.dispatch(P.callScript({configs:E}))}goToChartPage(){this.router.navigate([st.RUNNING.ROOT])}},p.\u0275fac=function(e){return new(e||p)(c(N),c(Gt),c(It),c(mt))},p.\u0275cmp=y({type:p,selectors:[["ms-machine-unlearning"]],viewQuery:function(e,i){if(e&1&&it(Qt,5),e&2){let o;rt(o=ot())&&(i.panelParametersComponent=o.first)}},decls:17,vars:5,consts:[["panelAlgorithm",""],["panelParameters",""],[1,"heading-primary-title","title"],[1,"page-wrapper",3,"formGroup"],[1,"left"],[3,"formGroup"],["controlKey","algorithm"],["controlKey","model",3,"algorithmType"],["controlKey","params",3,"algorithm"],["mat-raised-button","","color","primary",3,"click","disabled"],["mat-raised-button","","color","primary",1,"ml-2",3,"click"],[1,"right"]],template:function(e,i){if(e&1){let o=et();a(0,"p",2),h(1,"Model Compression"),s(),a(2,"div",3)(3,"div",4),Y(4,5),U(5,"ms-panel-algorithm",6,0)(7,"ms-panel-model",7)(8,"ms-panel-parameters",8,1),tt(),a(10,"div")(11,"button",9),K("click",function(){return w(o),j(i.submit())}),h(12," Run "),s(),a(13,"button",10),K("click",function(){return w(o),j(i.goToChartPage())}),h(14,"View Chart"),s()()(),a(15,"div",11),U(16,"ms-terminal-xterm-with-toolbar"),s()()}e&2&&(n(2),m("formGroup",i.form),n(2),m("formGroup",i.form),n(3),m("algorithmType",i.selectedAlgorithmType),n(),m("algorithm",i.selectedAlgorithm),n(3),m("disabled",i.isScriptActive||i.form.invalid))},dependencies:[_,O,b,M,ft,vt,I],styles:[".title[_ngcontent-%COMP%]{margin-bottom:13px}"]}),p);G=S([T()],G);var zt=[{path:"",component:G}],jt=(()=>{let t=class t{};t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=A({type:t}),t.\u0275inj=v({imports:[Q.forChild(zt),Q]});let r=t;return r})();var He=(()=>{let t=class t{};t.\u0275fac=function(o){return new(o||t)},t.\u0275mod=A({type:t}),t.\u0275inj=v({imports:[at,jt,_,O,b,_t,Tt,bt,St,Ct,yt]});let r=t;return r})();export{He as ModelCompressionModule};
