"use strict";(self.webpackChunkmodelsmith=self.webpackChunkmodelsmith||[]).push([[137],{4137:(le,Q,s)=>{s.r(Q),s.d(Q,{AlgorithmComparisonModule:()=>ce});var d=s(6814),R=s(5154),m=s(4221);const p=(0,m.R7)({source:"[Run Records -> Records]",events:{"Get Run Records Filenames":(0,m.Ky)(),"Get Run Records Filenames Success":(0,m.Ky)(),"Get Run Records Filenames Failure":(0,m.Ky)(),"Get Run Record Summarized Data":(0,m.Ky)(),"Get Run Record Summarized Data Success":(0,m.Ky)(),"Get Run Record Summarized Data Failure":(0,m.Ky)()}});var Y=s(4664),B=s(7398),G=s(6306),z=s(2096),mt=s(395),$=s(4992);class dt extends $.eW{constructor(e){super(`run-records-filenames/${e}`,void 0,void 0,!1)}}class pt extends $.eW{constructor(e,n){super(`run-records-summarized-data/${e}/${n}`,void 0,void 0,!1)}}var t=s(5879);let ut=(()=>{var o;class e{constructor(r,a){this.apiClient=r,this.actions$=a,this.getRunRecordsFilenames$=(0,R.GW)(()=>this.actions$.pipe((0,R.l4)(p.getRunRecordsFilenames),(0,Y.w)(i=>{const{algorithmType:l}=i;return this.apiClient.serviceCall(new dt(l)).pipe((0,B.U)(u=>p.getRunRecordsFilenamesSuccess({files:u})),(0,G.K)(u=>(0,z.of)(p.getRunRecordsFilenamesFailure({error:u}))))}))),this.getRunRecordSummarizedData$=(0,R.GW)(()=>this.actions$.pipe((0,R.l4)(p.getRunRecordSummarizedData),(0,Y.w)(i=>{const{algorithmType:l,filename:u}=i;return this.apiClient.serviceCall(new pt(l,u)).pipe((0,B.U)(Z=>p.getRunRecordSummarizedDataSuccess({record:Z})),(0,G.K)(Z=>(0,z.of)(p.getRunRecordSummarizedDataFailure({error:Z}))))})))}}return(o=e).\u0275fac=function(r){return new(r||o)(t.LFG(mt.I),t.LFG(R.eX))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac}),e})();const ht=(0,m.Lq)({filenames:[],summarizedRecord:{},error:""},(0,m.on)(p.getRunRecordsFilenamesSuccess,(o,{files:e})=>({...o,filenames:e,error:null})),(0,m.on)(p.getRunRecordsFilenamesFailure,(o,{error:e})=>({...o,error:e})),(0,m.on)(p.getRunRecordSummarizedData,o=>({...o,loading:!0,error:null})),(0,m.on)(p.getRunRecordSummarizedDataSuccess,(o,{record:e})=>({...o,summarizedRecord:e,error:null})),(0,m.on)(p.getRunRecordSummarizedDataFailure,(o,{error:e})=>({...o,error:e}))),Ct=(0,m.ZF)("runRecords"),H=(0,m.P1)(Ct,o=>o.records),ft=(0,m.P1)(H,o=>o.filenames),_t=(0,m.P1)(H,o=>o.summarizedRecord),vt={records:ht};var At=s(4245),g=s(9190),F=s(5094),K=s(9624),V=s(2655),N=s(7582),c=s(6223),f=s(8791),I=s(8180),A=s(7820),_=function(o){return o.ADD="add",o.EDIT="edit",o.VIEW="view",o}(_||{}),h=s(3305),Rt=s(3620),Tt=s(2181),q=s(836),j=s(155),T=s(4378),yt=s(874),X=s(301),W=s(6455),v=s(170);const tt=o=>/^#([0-9A-F]{3,4}){1,2}$/i.test(o)?xt(o):/^rgba?\(\d{1,3},\s*\d{1,3},\s*\d{1,3}(?:,\s*\d*\.?\d+)?\)$/i.test(o)?M(o):(console.warn("Unsupported color format:",o),new v.Il(0,0,0)),M=o=>{const e=o.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+\.?\d*))?\)$/);if(e){const n=parseInt(e[1],10),r=parseInt(e[2],10),a=parseInt(e[3],10),i=parseFloat(e[4]??"1");return new v.Il(n,r,a,i)}return console.warn("Failed to parse color:",o),new v.Il(0,0,0)},xt=o=>{const e=o.replace("#","").toUpperCase();let n,r,a,i=1;if([3,4].includes(e.length))n=parseInt(e.charAt(0).repeat(2),16),r=parseInt(e.charAt(1).repeat(2),16),a=parseInt(e.charAt(2).repeat(2),16),4===e.length&&(i=parseInt(e.charAt(3).repeat(2),16)/255);else{if(![6,8].includes(e.length))return console.warn("Invalid hex color format:",o),new v.Il(0,0,0);n=parseInt(e.substring(0,2),16),r=parseInt(e.substring(2,4),16),a=parseInt(e.substring(4,6),16),8===e.length&&(i=parseInt(e.substring(6,8),16)/255)}return new v.Il(n,r,a,i)};let et=(()=>{var o;class e{constructor(r){this.store=r,this.filenames$=this.store.select(ft),this.summarizedRecord$=this.store.select(_t)}dispatch(r){this.store.dispatch(r)}}return(o=e).\u0275fac=function(r){return new(r||o)(t.LFG(m.yh))},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac}),e})();var ot=s(5619);let y=(()=>{var o;class e{get algorithmType(){return this._algorithmType.value}get algorithmType$(){return this._algorithmType.asObservable()}set algorithmType(r){this._recordsMap.set(this._algorithmType.value,this._records.value),this._algorithmType.next(r);const a=this._recordsMap.get(r)||[];this._records.next(a)}get records(){return this._records.value}get records$(){return this._records.asObservable()}addRecord(r){const i=[...this._records.value,r];this._records.next(i),this._recordsMap.set(this._algorithmType.value,i)}updateRecord(r,a){const i=this._records.value;if(r>=0&&r<i.length){const l=[...i];l[r]=a,this._records.next(l),this._recordsMap.set(this._algorithmType.value,l)}}removeRecord(r){const a=this._records.value;if(r>=0&&r<a.length){const i=a.filter((l,u)=>u!==r);this._records.next(i),this._recordsMap.set(this._algorithmType.value,i)}}constructor(){this._recordsMap=new Map,this._records=new ot.X([]),this._algorithmType=new ot.X(A.Bd.PRUNING)}}return(o=e).\u0275fac=function(r){return new(r||o)},o.\u0275prov=t.Yz7({token:o,factory:o.\u0275fac}),e})();var St=s(8763),nt=s(6385),rt=s(2032),x=s(5683),at=s(8525),st=s(3680),bt=s(5940),it=s(7754);let Dt=(()=>{var o;class e{get parentFormGroup(){return this.controlContainer.control}get chartFormGroup(){return this.parentFormGroup.get(this.controlKey)}get borderColorControl(){return this.chartFormGroup.get(this.CHART_BODER_COLOR_CONTROL_NAME)}get backgroundColorControl(){return this.chartFormGroup.get(this.CHART_BACKGROUND_COLOR_CONTROL_NAME)}constructor(r){this.controlContainer=r,this.controlKey="",this.CHART_BODER_COLOR_CONTROL_NAME="borderColor",this.CHART_BACKGROUND_COLOR_CONTROL_NAME="backgroundColor"}ngOnInit(){}}return(o=e).\u0275fac=function(r){return new(r||o)(t.Y36(c.gN))},o.\u0275cmp=t.Xpm({type:o,selectors:[["ms-chart-colors-form-controls"]],inputs:{controlKey:"controlKey"},features:[t._Bn([],[{provide:c.gN,useFactory:()=>(0,t.f3M)(c.gN,{skipSelf:!0})}])],decls:17,vars:7,consts:[[3,"formGroupName"],[1,"form-field-container"],["matInput","",3,"ngxMatColorPicker","formControlName"],["matSuffix","",3,"for"],["pickerBorderColor",""],["pickerBackgroundColor",""]],template:function(r,a){if(1&r&&(t.ynx(0,0),t.TgZ(1,"div",1)(2,"mat-label"),t._uU(3,"Chart border color"),t.qZA(),t.TgZ(4,"mat-form-field"),t._UZ(5,"input",2)(6,"ngx-mat-color-toggle",3)(7,"ngx-mat-color-picker",null,4),t.qZA()(),t.TgZ(9,"div",1)(10,"mat-label"),t._uU(11,"Chart background color"),t.qZA(),t.TgZ(12,"mat-form-field"),t._UZ(13,"input",2)(14,"ngx-mat-color-toggle",3)(15,"ngx-mat-color-picker",null,5),t.qZA()(),t.BQk()),2&r){const i=t.MAs(8),l=t.MAs(16);t.Q6J("formGroupName",a.controlKey),t.xp6(5),t.Q6J("ngxMatColorPicker",i)("formControlName",a.CHART_BODER_COLOR_CONTROL_NAME),t.xp6(1),t.Q6J("for",i),t.xp6(7),t.Q6J("ngxMatColorPicker",l)("formControlName",a.CHART_BACKGROUND_COLOR_CONTROL_NAME),t.xp6(1),t.Q6J("for",l)}},dependencies:[rt.Nt,x.KE,x.hX,x.R9,v.p2,v._f,v._C,c.Fj,c.JJ,c.JL,c.u,c.x0]}),e})();var S,wt=s(5844),ct=s(7602);function Zt(o,e){if(1&o&&(t.TgZ(0,"mat-option",9),t._uU(1),t.qZA()),2&o){const n=e.$implicit;t.Q6J("value",n.name)("disabled",n.disabled),t.xp6(1),t.hij(" ",n.name," ")}}function Ot(o,e){1&o&&(t.TgZ(0,"div")(1,"div",10),t._UZ(2,"mat-spinner",11),t.qZA()())}function Nt(o,e){if(1&o&&(t.ynx(0),t._uU(1),t.ALo(2,"readableDuration"),t.BQk()),2&o){const n=t.oxw().$implicit;t.xp6(1),t.Oqu(t.lcZ(2,1,n.value))}}function Ft(o,e){if(1&o&&(t.ynx(0),t._uU(1),t.BQk()),2&o){const n=t.oxw().$implicit;t.xp6(1),t.Oqu(n.value)}}function It(o,e){1&o&&(t.TgZ(0,"div",27),t._UZ(1,"mat-divider"),t.qZA())}function Mt(o,e){if(1&o&&(t.TgZ(0,"div",19)(1,"div",20)(2,"div",21),t._uU(3),t.ALo(4,"parametersLabel"),t.qZA(),t.TgZ(5,"div",22),t.ynx(6,23),t.YNc(7,Nt,3,3,"ng-container",24),t.YNc(8,Ft,2,1,"ng-container",25),t.BQk(),t.qZA()(),t.YNc(9,It,2,0,"div",26),t.qZA()),2&o){const n=e.$implicit,r=e.last;t.xp6(3),t.hij("",t.lcZ(4,4,n.key),":"),t.xp6(3),t.Q6J("ngSwitch",n.key),t.xp6(1),t.Q6J("ngSwitchCase","duration_seconds"),t.xp6(2),t.Q6J("ngIf",!r)}}function Et(o,e){if(1&o){const n=t.EpF();t.TgZ(0,"mat-expansion-panel",16),t.NdJ("expandedChange",function(a){t.CHM(n);const i=t.oxw(3);return t.KtG(i.panelStates.statistics=a)}),t.TgZ(1,"mat-expansion-panel-header")(2,"mat-panel-title",17),t._uU(3," Statistics "),t.qZA()(),t.YNc(4,Mt,10,6,"div",18),t.qZA()}if(2&o){const n=e.$implicit,r=t.oxw(3);t.Q6J("expanded",r.panelStates.statistics),t.xp6(4),t.Q6J("ngForOf",n)}}function Lt(o,e){1&o&&(t.TgZ(0,"div",27),t._UZ(1,"mat-divider"),t.qZA())}function Ut(o,e){if(1&o&&(t.TgZ(0,"div",19)(1,"div",20)(2,"div",21),t._uU(3),t.ALo(4,"parametersLabel"),t.qZA(),t.TgZ(5,"div",22),t._uU(6),t.qZA()(),t.YNc(7,Lt,2,0,"div",26),t.qZA()),2&o){const n=e.$implicit,r=e.last;t.xp6(3),t.hij("",t.lcZ(4,3,n.key),":"),t.xp6(3),t.hij(" ",n.value," "),t.xp6(1),t.Q6J("ngIf",!r)}}function Pt(o,e){if(1&o){const n=t.EpF();t.TgZ(0,"mat-expansion-panel",16),t.NdJ("expandedChange",function(a){t.CHM(n);const i=t.oxw(3);return t.KtG(i.panelStates.parameters=a)}),t.TgZ(1,"mat-expansion-panel-header")(2,"mat-panel-title",17),t._uU(3," Parameters "),t.qZA()(),t.YNc(4,Ut,8,5,"div",18),t.qZA()}if(2&o){const n=e.$implicit,r=t.oxw(3);t.Q6J("expanded",r.panelStates.parameters),t.xp6(4),t.Q6J("ngForOf",n)}}function kt(o,e){if(1&o){const n=t.EpF();t.TgZ(0,"mat-expansion-panel",16),t.NdJ("expandedChange",function(a){t.CHM(n);const i=t.oxw(3);return t.KtG(i.panelStates.accuracy=a)}),t.TgZ(1,"mat-expansion-panel-header")(2,"mat-panel-title",17),t._uU(3," Last Accuracy Test Run "),t.qZA()(),t._UZ(4,"ms-chart-colors-form-controls",28)(5,"ms-line-chart",29),t.qZA()}if(2&o){const n=t.oxw(3);t.Q6J("expanded",n.panelStates.accuracy),t.xp6(5),t.Q6J("data",n.lastRunAccuracyTestingChartData)("settings",n.testingAccuracyChartDisplaySettings)}}function Jt(o,e){if(1&o&&(t.ynx(0),t._UZ(1,"mat-divider"),t.TgZ(2,"div",12)(3,"mat-label"),t._uU(4,"Set run name"),t.qZA(),t.TgZ(5,"mat-form-field",3),t._UZ(6,"input",13),t.qZA()(),t.TgZ(7,"mat-accordion",14),t.YNc(8,Et,5,2,"mat-expansion-panel",15),t.ALo(9,"keyvalue"),t.YNc(10,Pt,5,2,"mat-expansion-panel",15),t.ALo(11,"keyvalue"),t.YNc(12,kt,6,3,"mat-expansion-panel",15),t.ALo(13,"keyvalue"),t.qZA(),t.BQk()),2&o){const n=t.oxw(2);t.xp6(8),t.Q6J("ngIf",t.lcZ(9,3,null==n.summarizedRecord?null:n.summarizedRecord.statistics)),t.xp6(2),t.Q6J("ngIf",t.lcZ(11,5,null==n.summarizedRecord?null:n.summarizedRecord.parameters)),t.xp6(2),t.Q6J("ngIf",t.lcZ(13,7,null==n.summarizedRecord?null:n.summarizedRecord.parameters))}}function Qt(o,e){if(1&o&&t.YNc(0,Jt,14,9,"ng-container",6),2&o){const n=t.oxw(),r=t.MAs(13);t.Q6J("ngIf",!!n.summarizedRecord)("ngIfElse",r)}}function Yt(o,e){1&o&&t._UZ(0,"ms-empty-state",30)}let O=((S=class{get chartFormGroup(){return this.form.get("chart")}get selectRunFormControl(){return this.form.get("selectRun")}get runNameFormControl(){return this.form.get("runName")}constructor(e,n,r,a,i,l){this.drawerRef=e,this.drawerConfig=n,this.fb=r,this.recordsFacadeService=a,this.recordsDataService=i,this.customAPILoadingService=l,this.panelStates={statistics:!0,parameters:!0,accuracy:!0},this.form=new c.cw({}),this.files=[],this.isSummarizedRecordLoading$=this.customAPILoadingService.getLoadingObservableForKey(j.dh.RUN_RECORDS_SUMMARIZED_DATA),this.testingAccuracyChartDisplaySettings={},this.lastRunAccuracyTestingChartData=[]}ngAfterViewInit(){this.restorePanelStates()}ngOnInit(){switch(this.initForm(),this.initChartDisplaySettings(),this.listenToChartColorChanges(),this.drawerConfig.actionType){case _.ADD:this.loadData(),this.configureAddTypeActions();break;case _.EDIT:case _.VIEW:this.configureEditOrViewTypeActions()}}initChartDisplaySettings(){let e=0;switch(this.recordsDataService.algorithmType){case A.Bd.PRUNING:e=100;break;case A.Bd.QUANTIZATION:e=79}this.testingAccuracyChartDisplaySettings={yAxisMinimumValue:0,yAxisTickInterval:20,chartDataStructure:W.nR.SINGLE_PHASE_X_AXIS,xAxisDataPointsCount:e,yAxisMaximumValue:100,isXAxisVisible:!1,areTooltipsEnabled:!0,xAxisLabelPrefix:"Step:",datasetLabelPrefix:"Test:",isChartWithCustomColorSettings:!0,customChartColors:{datasetColors:[{backgroundColor:"rgba(241, 196, 15, 0.2)",borderColor:"#f1c40f"}]}}}listenToChartColorChanges(){this.chartFormGroup.valueChanges.pipe((0,Rt.b)(300),(0,f.t)(this)).subscribe(e=>{if((0,T.Qr)(e))return;const{backgroundColor:n,borderColor:r}=e,{rgba:a}=n,{rgba:i}=r;this.testingAccuracyChartDisplaySettings={...this.testingAccuracyChartDisplaySettings,customChartColors:{datasetColors:[{backgroundColor:a,borderColor:i}]}},this.lastRunAccuracyTestingChartData=[...this.lastRunAccuracyTestingChartData]})}configureEditOrViewTypeActions(){const{recordName:e,recordFilename:n,record:r,chartColors:a}=this.drawerConfig.data;this.drawerConfig.actionType===_.VIEW?this.form.disable():this.drawerConfig.actionType===_.EDIT&&this.selectRunFormControl.disable(),this.files=[{name:n,disabled:!0}],this.form.patchValue({selectRun:n,runName:e,chart:{borderColor:M(a.borderColor),backgroundColor:M(a.backgroundColor)}}),this.summarizedRecord=r,this.lastRunAccuracyTestingChartData=this.configureChartDataset(r),this.testingAccuracyChartDisplaySettings={...this.testingAccuracyChartDisplaySettings,hasCustomDatasetsLabels:!0,customDatasetsLabels:[e],customChartColors:{datasetColors:[{backgroundColor:a.backgroundColor||"rgba(241, 196, 15, 0.2)",borderColor:a.borderColor||"#f1c40f"}]}}}configureAddTypeActions(){this.listenToSelectRunFormValueChanges(),this.listenToSummarizedRecordChanges()}listenToSelectRunFormValueChanges(){this.selectRunFormControl.valueChanges.pipe((0,f.t)(this),(0,Tt.h)(e=>!(0,T.Bm)(e))).subscribe(e=>{this.runNameFormControl.reset(),this.recordsFacadeService.dispatch(p.getRunRecordSummarizedData({algorithmType:this.recordsDataService.algorithmType,filename:e}))})}listenToSummarizedRecordChanges(){this.recordsFacadeService.summarizedRecord$.pipe((0,f.t)(this),(0,q.T)(1)).subscribe(e=>{this.summarizedRecord=e,this.lastRunAccuracyTestingChartData=this.configureChartDataset(e);const n=this.summarizedRecord?.statistics.algorithm_key,r=this.summarizedRecord?.parameters.arch;!(0,T.Bm)(n)&&!(0,T.Bm)(r)&&this.runNameFormControl.setValue(`${n}_${r}`),this.savePanelStates(),this.restorePanelStates()})}configureChartDataset(e){return[{datasetIndex:0,values:e.lastRunTestingAccuracyData||[]}]}loadData(){this.recordsFacadeService.dispatch(p.getRunRecordsFilenames({algorithmType:this.recordsDataService.algorithmType})),this.recordsFacadeService.filenames$.pipe((0,q.T)(1),(0,I.q)(1)).subscribe(e=>{const n=new Set(this.recordsDataService.records.map(r=>r.recordFilename));this.files=e.map(r=>({name:r,disabled:n.has(r)}))})}initForm(){const e=this.getDefaultChartColors();this.form=this.fb.group({selectRun:[null,c.kI.required],runName:[null,c.kI.required],chart:this.fb.group({borderColor:[e.borderColor,c.kI.required],backgroundColor:[e.backgroundColor,c.kI.required]})})}getDefaultChartColors(){const e=Math.max(this.recordsDataService.records.length,0),n=yt.g[X.g.YELLOW].datasetColors[e];return{borderColor:tt(n.borderColor),backgroundColor:tt(n.backgroundColor)}}save(e){if(e!==g.ni.SAVE)return;const{backgroundColor:n,borderColor:r}=this.form.get("chart")?.getRawValue(),{rgba:a}=n,{rgba:i}=r;this.drawerRef.close({result:{recordName:this.runNameFormControl.value,recordFilename:this.selectRunFormControl.value,record:this.summarizedRecord,chartColors:{backgroundColor:a,borderColor:i}},status:e})}close(){this.drawerRef.close()}savePanelStates(){this.panels.forEach((e,n)=>{this.panelStates[n]=e.expanded})}restorePanelStates(){this.panels.forEach((e,n)=>{void 0!==this.panelStates[n]&&(e.expanded=this.panelStates[n])})}}).\u0275fac=function(e){return new(e||S)(t.Y36(g.Pf),t.Y36(g.ZI),t.Y36(c.qu),t.Y36(et),t.Y36(y),t.Y36(j.Fv))},S.\u0275cmp=t.Xpm({type:S,selectors:[["ms-run-drawer-actions"]],viewQuery:function(e,n){if(1&e&&t.Gf(h.ib,5),2&e){let r;t.iGM(r=t.CRH())&&(n.panels=r)}},decls:14,vars:7,consts:[[3,"isSaveDisabled","actionEvent"],[3,"formGroup"],[1,"form-field-container"],["appearance","outline"],["formControlName","selectRun","placeholder","Select a run record"],[3,"value","disabled",4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],["content",""],["noData",""],[3,"value","disabled"],[1,"spinner-wrapper","mt-4"],["diameter","80"],[1,"form-field-container","mt-4"],["matInput","","formControlName","runName","placeholder","Set run name"],["multi",""],[3,"expanded","expandedChange",4,"ngIf"],[3,"expanded","expandedChange"],[1,"paragraph-bold-p3-small-bold"],["class","key-value-container single",4,"ngFor","ngForOf"],[1,"key-value-container","single"],[1,"key-value-pair","space-between"],[1,"key-value-key"],[1,"key-value-value"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],["class","pt-2",4,"ngIf"],[1,"pt-2"],["controlKey","chart"],[3,"data","settings"],["title","Awaiting Run Record Selection","message","Select a run record from the dropdown to view details and statistics."]],template:function(e,n){if(1&e&&(t.TgZ(0,"ms-drawer",0),t.NdJ("actionEvent",function(a){return n.save(a)}),t.TgZ(1,"form",1)(2,"div",2)(3,"mat-label"),t._uU(4,"Select run record"),t.qZA(),t.TgZ(5,"mat-form-field",3)(6,"mat-select",4),t.YNc(7,Zt,2,3,"mat-option",5),t.qZA()()(),t.YNc(8,Ot,3,0,"div",6),t.ALo(9,"async"),t.YNc(10,Qt,1,2,"ng-template",null,7,t.W1O),t.qZA()(),t.YNc(12,Yt,1,0,"ng-template",null,8,t.W1O)),2&e){const r=t.MAs(11);t.Q6J("isSaveDisabled",n.form.invalid),t.xp6(1),t.Q6J("formGroup",n.form),t.xp6(6),t.Q6J("ngForOf",n.files),t.xp6(1),t.Q6J("ngIf",t.lcZ(9,5,n.isSummarizedRecordLoading$))("ngIfElse",r)}},dependencies:[d.sg,d.O5,d.RF,d.n9,d.ED,St.k,nt.d,rt.Nt,x.KE,x.hX,at.gD,st.ey,bt.Ou,h.pp,h.ib,h.yz,h.yK,c._Y,c.Fj,c.JJ,c.JL,c.sg,c.u,F.w,it.u,Dt,d.Ov,d.Nd,wt.n,ct.N],styles:[".spinner-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:center}"]}),S);O=(0,N.gn)([(0,f.c)()],O);var lt=s(2296),E=s(617),Bt=s(5195),L=s(2596);let Gt=(()=>{var o;class e{get lineClamp(){return this.maxEllipsisLines}onMouseEnter(){this.isTextOverflowing?this.tooltip.show():this.tooltip.hide()}onMouseLeave(){this.tooltip.hide()}constructor(r,a){this.tooltip=r,this.elementRef=a,this.maxEllipsisLines=2,this.display="-webkit-box",this.overflow="hidden",this.boxOrient="vertical",this.textOverflow="ellipsis",this.whiteSpace="normal",this.wordBreak="break-all"}ngAfterViewInit(){setTimeout(()=>{this.tooltip.message=this.elementRef.nativeElement.textContent.trim(),this.tooltip.position="above"},0)}get isTextOverflowing(){const r=parseInt(window.getComputedStyle(this.elementRef.nativeElement).lineHeight);return this.elementRef.nativeElement.scrollHeight>this.maxEllipsisLines*r}}return(o=e).\u0275fac=function(r){return new(r||o)(t.Y36(L.gM),t.Y36(t.SBq))},o.\u0275dir=t.lG2({type:o,selectors:[["","msUseEllipsis",""]],hostVars:14,hostBindings:function(r,a){1&r&&t.NdJ("mouseenter",function(){return a.onMouseEnter()})("mouseleave",function(){return a.onMouseLeave()}),2&r&&t.Udp("display",a.display)("overflow",a.overflow)("-webkit-box-orient",a.boxOrient)("-webkit-line-clamp",a.lineClamp)("text-overflow",a.textOverflow)("white-space",a.whiteSpace)("word-break",a.wordBreak)},inputs:{maxEllipsisLines:"maxEllipsisLines"},standalone:!0,features:[t._Bn([L.gM])]}),e})();function zt(o,e){if(1&o){const n=t.EpF();t.TgZ(0,"mat-card",3)(1,"div",4)(2,"div",5),t._uU(3),t.qZA(),t.TgZ(4,"div",6)(5,"button",7),t.NdJ("click",function(){const i=t.CHM(n).$implicit,l=t.oxw(2);return t.KtG(l.viewRecord(i))}),t._UZ(6,"mat-icon",8),t.qZA(),t.TgZ(7,"button",7),t.NdJ("click",function(){const a=t.CHM(n),i=a.index,l=a.$implicit,u=t.oxw(2);return t.KtG(u.editRecord(i,l))}),t._UZ(8,"mat-icon",9),t.qZA(),t.TgZ(9,"button",10),t.NdJ("click",function(){const i=t.CHM(n).index,l=t.oxw(2);return t.KtG(l.removeRecord(i))}),t.TgZ(10,"mat-icon",11),t._uU(11,"delete"),t.qZA()()()()()}if(2&o){const n=e.$implicit;t.xp6(3),t.Oqu(n.recordName)}}function $t(o,e){if(1&o&&(t.ynx(0),t.YNc(1,zt,12,1,"mat-card",2),t.BQk()),2&o){const n=e.ngIf;t.xp6(1),t.Q6J("ngForOf",n)}}let Ht=(()=>{var o;class e{constructor(r,a){this.recordsDataService=r,this.drawerService=a}removeRecord(r){this.recordsDataService.removeRecord(r)}viewRecord(r){this.drawerService.open(O,{title:"View Run",showSaveButton:!1,showCloseButton:!0,closeButtonLabel:"Close",actionType:_.VIEW,data:r})}editRecord(r,a){this.drawerService.open(O,{title:"Edit Run",saveButtonLabel:"Update",showCloseButton:!0,closeButtonLabel:"Close",actionType:_.EDIT,data:a}).afterClosed().pipe((0,I.q)(1)).subscribe(l=>{const{status:u}=l;if(u===g.ni.DISMISS||u===g.ni.CLOSE)return;const{result:Z}=l;(0,T.Qr)(Z)||this.recordsDataService.updateRecord(r,Z)})}}return(o=e).\u0275fac=function(r){return new(r||o)(t.Y36(y),t.Y36(g.zv))},o.\u0275cmp=t.Xpm({type:o,selectors:[["ms-algorithm-comparison-list"]],decls:3,vars:3,consts:[[1,"items-wrapper"],[4,"ngIf"],["class","ms-card comparison-item",4,"ngFor","ngForOf"],[1,"ms-card","comparison-item"],[1,"item-wrapper"],["msUseEllipsis",""],[1,"record-summary-buttons-wrapper"],["mat-icon-button","","color","primary",3,"click"],["fontSet","ms","fontIcon","icon-Eye",1,"mat-primary"],["fontSet","ms","fontIcon","icon-PencilSimple",1,"mat-primary"],["mat-icon-button","","color","error",3,"click"],[1,"mat-error"]],template:function(r,a){1&r&&(t.TgZ(0,"div",0),t.YNc(1,$t,2,1,"ng-container",1),t.ALo(2,"async"),t.qZA()),2&r&&(t.xp6(1),t.Q6J("ngIf",t.lcZ(2,1,a.recordsDataService.records$)))},dependencies:[d.sg,d.O5,lt.RK,E.Hw,Bt.a8,Gt,d.Ov],styles:[".items-wrapper[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(250px,1fr));grid-gap:20px;padding:20px 0}.items-wrapper[_ngcontent-%COMP%]   .ms-card[_ngcontent-%COMP%]:hover{box-shadow:0 8px 16px #0003}.items-wrapper[_ngcontent-%COMP%]   .comparison-item[_ngcontent-%COMP%]   .item-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.items-wrapper[_ngcontent-%COMP%]   .comparison-item[_ngcontent-%COMP%]   .item-wrapper[_ngcontent-%COMP%]   .record-summary-buttons-wrapper[_ngcontent-%COMP%]{display:flex}"]}),e})();var b,Kt=s(2599);let U=((b=class{constructor(e,n){this.recordsDataService=e,this.chartToolsGlobalSignalsService=n,this.testingAccuracyChartDisplaySettings={yAxisMinimumValue:0,yAxisTickInterval:20,chartDataStructure:W.nR.SINGLE_PHASE_X_AXIS,yAxisMaximumValue:100,datasetColorSettingsKey:X.g.YELLOW,isXAxisVisible:!1,xAxisLabelPrefix:"Step:",hasCustomDatasetsLabels:!0},this.lastRunsAccuracyTestingChartData=[]}ngOnInit(){this.listenToRecordsChanges()}listenToRecordsChanges(){this.recordsDataService.records$.pipe((0,f.t)(this)).subscribe(e=>{this.lastRunsAccuracyTestingChartData=this.configureChartDatasets(e);let n=0;switch(this.recordsDataService.algorithmType){case A.Bd.PRUNING:n=100;break;case A.Bd.QUANTIZATION:n=79}this.testingAccuracyChartDisplaySettings={...this.testingAccuracyChartDisplaySettings,xAxisDataPointsCount:n,customDatasetsLabels:e.map(r=>r.recordName),isChartWithCustomColorSettings:!0,customChartColors:{datasetColors:e.map(r=>r.chartColors)}}})}configureChartDatasets(e){const n=[];return e.forEach((r,a)=>{const{record:i}=r;n.push({datasetIndex:a,values:i.lastRunTestingAccuracyData||[]})}),n}toggleTooltip(e){this.chartToolsGlobalSignalsService.toggleTooltips=e.checked}toggleZoom(e){this.chartToolsGlobalSignalsService.toggleZoom=e.checked}}).\u0275fac=function(e){return new(e||b)(t.Y36(y),t.Y36(K.d))},b.\u0275cmp=t.Xpm({type:b,selectors:[["ms-algorithm-comparison-chart"]],decls:14,vars:2,consts:[["expanded","true"],[1,"paragraph-bold-p3-small-bold"],[1,"mt-2","flex"],["color","primary",3,"change"],[1,"flex"],["color","primary",1,"ml-2",3,"change"],[1,"ml-1"],["fontSet","ms","fontIcon","icon-Info","matTooltip","Use mouse wheel or touchpad pinch to zoom in/out. Drag to select an area for specific zoom, or use touchpad gestures to navigate."],[3,"data","settings"]],template:function(e,n){1&e&&(t.TgZ(0,"mat-expansion-panel",0)(1,"mat-expansion-panel-header")(2,"mat-panel-title",1),t._uU(3," Last Accuracy Test Run "),t.qZA()(),t.TgZ(4,"div",2)(5,"div")(6,"mat-slide-toggle",3),t.NdJ("change",function(a){return n.toggleTooltip(a)}),t._uU(7," Enable tooltips "),t.qZA()(),t.TgZ(8,"div",4)(9,"mat-slide-toggle",5),t.NdJ("change",function(a){return n.toggleZoom(a)}),t._uU(10," Enable zoom "),t.qZA(),t.TgZ(11,"div",6),t._UZ(12,"mat-icon",7),t.qZA()()(),t._UZ(13,"ms-line-chart",8),t.qZA()),2&e&&(t.xp6(13),t.Q6J("data",n.lastRunsAccuracyTestingChartData)("settings",n.testingAccuracyChartDisplaySettings))},dependencies:[E.Hw,L.gM,Kt.Rr,h.ib,h.yz,h.yK,F.w]}),b);U=(0,N.gn)([(0,f.c)()],U);var P=s(3566),C=s(5313);let Vt=(()=>{var o;class e{transform(r){return"string"==typeof r&&r&&"None"!=r||"number"==typeof r&&!isNaN(r)?r.toString():"-"}}return(o=e).\u0275fac=function(r){return new(r||o)},o.\u0275pipe=t.Yjl({name:"emptyTableField",type:o,pure:!0,standalone:!0}),e})();var D;function qt(o,e){1&o&&(t.TgZ(0,"th",10),t._uU(1,"Record Name"),t.qZA())}function jt(o,e){if(1&o&&(t.TgZ(0,"td",11),t._uU(1),t.qZA()),2&o){const n=e.$implicit;t.xp6(1),t.Oqu(n.recordName)}}function Xt(o,e){if(1&o&&(t.TgZ(0,"th",10),t._uU(1),t.ALo(2,"parametersLabel"),t.qZA()),2&o){const n=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,n)," ")}}function Wt(o,e){if(1&o&&(t.TgZ(0,"td",11),t._uU(1),t.ALo(2,"emptyTableField"),t.qZA()),2&o){const n=e.$implicit,r=t.oxw().$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,n[r])," ")}}function te(o,e){1&o&&(t.ynx(0,12),t.YNc(1,Xt,3,3,"th",5),t.YNc(2,Wt,3,3,"td",6),t.BQk()),2&o&&t.Q6J("matColumnDef",e.$implicit)}function ee(o,e){1&o&&t._UZ(0,"tr",13)}function oe(o,e){1&o&&t._UZ(0,"tr",14)}let k=((D=class{constructor(e){this.recordsDataService=e,this.dataSource=new C.by,this.displayedColumns=[]}ngOnInit(){this.recordsDataService.records$.pipe((0,f.t)(this)).subscribe(e=>{this.updateDisplayedColumns(e),this.updateDataSource(e)})}ngAfterViewInit(){(0,T.Qr)(this.sort)||setTimeout(()=>{this.dataSource.sort=this.sort},1200)}updateDisplayedColumns(e){const n=new Set;e.forEach(r=>{Object.keys(r.record.parameters).forEach(a=>{"save_dir"!==a&&n.add(a)})}),this.displayedColumns=["recordName",...Array.from(n)]}updateDataSource(e){const n=e.map(r=>({recordName:r.recordName,...r.record.parameters}));this.dataSource.data=n}}).\u0275fac=function(e){return new(e||D)(t.Y36(y))},D.\u0275cmp=t.Xpm({type:D,selectors:[["ms-algorithm-comparison-table"]],viewQuery:function(e,n){if(1&e&&t.Gf(P.YE,5),2&e){let r;t.iGM(r=t.CRH())&&(n.sort=r.first)}},decls:12,vars:4,consts:[["expanded","true"],[1,"paragraph-bold-p3-small-bold"],[1,"table-container"],["mat-table","","matSort","",1,"mat-table",3,"dataSource"],["matColumnDef","recordName"],["mat-header-cell","","mat-sort-header","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],[3,"matColumnDef",4,"ngFor","ngForOf"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","","class","hover-highlight",4,"matRowDef","matRowDefColumns"],["mat-header-cell","","mat-sort-header",""],["mat-cell",""],[3,"matColumnDef"],["mat-header-row",""],["mat-row","",1,"hover-highlight"]],template:function(e,n){1&e&&(t.TgZ(0,"mat-expansion-panel",0)(1,"mat-expansion-panel-header")(2,"mat-panel-title",1),t._uU(3," Parameters "),t.qZA()(),t.TgZ(4,"div",2)(5,"table",3),t.ynx(6,4),t.YNc(7,qt,2,0,"th",5),t.YNc(8,jt,2,1,"td",6),t.BQk(),t.YNc(9,te,3,1,"ng-container",7),t.YNc(10,ee,1,0,"tr",8),t.YNc(11,oe,1,0,"tr",9),t.qZA()()()),2&e&&(t.xp6(5),t.Q6J("dataSource",n.dataSource),t.xp6(4),t.Q6J("ngForOf",n.displayedColumns.slice(1)),t.xp6(1),t.Q6J("matHeaderRowDef",n.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",n.displayedColumns))},dependencies:[d.sg,C.BZ,C.fO,C.as,C.w1,C.Dz,C.nj,C.ge,C.ev,C.XQ,C.Gk,P.YE,P.nU,h.ib,h.yz,h.yK,ct.N,Vt],styles:[".table-container[_ngcontent-%COMP%]{overflow-x:auto;white-space:nowrap;width:87vw}.hover-highlight[_ngcontent-%COMP%]:hover{background-color:var(--backgrounds-80)}.mat-column-disable_8bit_head_stem[_ngcontent-%COMP%]{min-width:200px}.mat-column-workers[_ngcontent-%COMP%], .mat-column-n_bits_w[_ngcontent-%COMP%], .mat-column-channel_wise[_ngcontent-%COMP%], .mat-column-n_bits_a[_ngcontent-%COMP%]{min-width:160px}.mat-column-act_quant[_ngcontent-%COMP%]{min-width:180px}.mat-column-num_samples[_ngcontent-%COMP%], .mat-column-iters_w[_ngcontent-%COMP%]{min-width:160px}.mat-column-keep_cpu[_ngcontent-%COMP%], .mat-column-awq[_ngcontent-%COMP%]{min-width:180px}.mat-column-aaq[_ngcontent-%COMP%], .mat-column-init_wmode[_ngcontent-%COMP%], .mat-column-init_amode[_ngcontent-%COMP%]{min-width:200px}"]}),D);var w;function ne(o,e){if(1&o&&(t.TgZ(0,"mat-option",13),t._uU(1),t.qZA()),2&o){const n=e.$implicit;t.Q6J("value",n.key),t.xp6(1),t.hij(" ",n.value," ")}}function re(o,e){1&o&&(t.ynx(0),t._UZ(1,"ms-algorithm-comparison-list"),t.TgZ(2,"div",7),t._UZ(3,"mat-divider"),t.qZA(),t._UZ(4,"ms-algorithm-comparison-table"),t.TgZ(5,"div",7),t._UZ(6,"mat-divider"),t.qZA(),t._UZ(7,"ms-algorithm-comparison-chart"),t.BQk())}function ae(o,e){1&o&&(t.TgZ(0,"div",14),t._UZ(1,"ms-empty-state",15),t.qZA())}k=(0,N.gn)([(0,f.c)()],k);let J=((w=class{get algorithmTypeFormControl(){return this.form.get(this.ALGORITHM_TYPE_CONTROL_NAME)}constructor(e,n,r){this.drawerService=e,this.recordsDataService=n,this.fb=r,this.form=new c.cw({}),this.algorithmTypesOptions=A.VN.filter(a=>a.key!==A.Bd.TRAIN),this.ALGORITHM_TYPE_CONTROL_NAME="algorithmType"}openAddRunDrawer(){this.drawerService.open(O,{title:"Add Run",saveButtonLabel:"Add",showCloseButton:!0,closeButtonLabel:"Close",actionType:_.ADD}).afterClosed().pipe((0,I.q)(1)).subscribe(n=>{const{status:r}=n;if(r===g.ni.DISMISS||r===g.ni.CLOSE)return;const{result:a}=n;this.recordsDataService.addRecord(a)})}ngOnInit(){this.initForm(),this.listenToAlgorithmTypeChanges()}initForm(){this.form=this.fb.group({[this.ALGORITHM_TYPE_CONTROL_NAME]:[this.recordsDataService.algorithmType,c.kI.required]})}listenToAlgorithmTypeChanges(){this.algorithmTypeFormControl.valueChanges.pipe((0,f.t)(this)).subscribe(e=>{this.recordsDataService.algorithmType=e})}trackByAlgorithmType(e,n){return n.key}}).\u0275fac=function(e){return new(e||w)(t.Y36(g.zv),t.Y36(y),t.Y36(c.qu))},w.\u0275cmp=t.Xpm({type:w,selectors:[["ms-algorithm-comparison"]],decls:19,vars:8,consts:[[1,"title-wrapper"],[1,"heading-primary-title","title"],[1,"ml-2",3,"formGroup"],[1,"form-field-container","w-56","mt-2"],["appearance","outline"],["placeholder","Select a run record",3,"formControlName"],[3,"value",4,"ngFor","ngForOf","ngForTrackBy"],[1,"mt-4","mb-4"],["mat-stroked-button","","color","primary",3,"click"],["fontSet","ms","fontIcon","icon-Plus"],[1,"mt-4"],[4,"ngIf","ngIfElse"],["noData",""],[3,"value"],[1,"no-data-wrapper"],["title","No data selected"]],template:function(e,n){if(1&e&&(t.TgZ(0,"div",0)(1,"p",1),t._uU(2,"Algorithm Comparison for"),t.qZA(),t.TgZ(3,"form",2)(4,"div",3)(5,"mat-form-field",4)(6,"mat-select",5),t.YNc(7,ne,2,2,"mat-option",6),t.qZA()()()()(),t.TgZ(8,"div",7),t._UZ(9,"mat-divider"),t.qZA(),t.TgZ(10,"button",8),t.NdJ("click",function(){return n.openAddRunDrawer()}),t._UZ(11,"mat-icon",9),t._uU(12," Add run\n"),t.qZA(),t.TgZ(13,"div",10),t._UZ(14,"mat-divider"),t.qZA(),t.YNc(15,re,8,0,"ng-container",11),t.ALo(16,"async"),t.YNc(17,ae,2,0,"ng-template",null,12,t.W1O)),2&e){const r=t.MAs(18);t.xp6(3),t.Q6J("formGroup",n.form),t.xp6(3),t.Q6J("formControlName",n.ALGORITHM_TYPE_CONTROL_NAME),t.xp6(1),t.Q6J("ngForOf",n.algorithmTypesOptions)("ngForTrackBy",n.trackByAlgorithmType),t.xp6(8),t.Q6J("ngIf",t.lcZ(16,6,n.recordsDataService.records$).length>0)("ngIfElse",r)}},dependencies:[d.sg,d.O5,nt.d,lt.lW,E.Hw,x.KE,at.gD,st.ey,c._Y,c.JJ,c.JL,c.sg,c.u,it.u,Ht,U,k,d.Ov],styles:[".no-data-wrapper[_ngcontent-%COMP%]{display:flex;justify-content:center}.title-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center}"]}),w);J=(0,N.gn)([(0,f.c)()],J);const se=[{path:"",component:J}];let ie=(()=>{var o;class e{}return(o=e).\u0275fac=function(r){return new(r||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[V.Bz.forChild(se),V.Bz]}),e})(),ce=(()=>{var o;class e{}return(o=e).\u0275fac=function(r){return new(r||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({providers:[g.zv,et,y,K.d],imports:[d.ez,ie,g.kZ,At.m,m.Aw.forFeature("runRecords",vt),R.sQ.forFeature([ut]),F.w]}),e})()}}]);